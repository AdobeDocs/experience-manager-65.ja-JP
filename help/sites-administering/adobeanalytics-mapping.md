---
title: コンポーネントデータと Adobe Analytics プロパティとのマッピング
description: コンポーネントデータをマッピングする方法について、SiteCatalystのプロパティを参照してください。
contentOwner: User
products: SG_EXPERIENCEMANAGER/6.5/SITES
topic-tags: integration
content-type: reference
docset: aem65
exl-id: c7c0c705-ec16-40f5-ad08-193f82d01263
source-git-commit: fc2f26a69c208947c14e8c6036825bb217901481
workflow-type: tm+mt
source-wordcount: '1449'
ht-degree: 53%

---

# コンポーネントデータと Adobe Analytics プロパティとのマッピング{#mapping-component-data-with-adobe-analytics-properties}

Adobe Analyticsに送信するデータを収集するフレームワークにコンポーネントを追加します。 分析データを収集するように設計されたコンポーネントは、データを適切な **CQ 変数**. そのようなコンポーネントをフレームワークに追加する場合、フレームワークは CQ 変数のリストを表示して、適切な **Analytics** 変数にマッピングできるようにします。

![aa-11](assets/aa-11.png)

**AEM ビュー**&#x200B;が開いている場合、Analytics 変数はコンテンツファインダーに表示されます。

![aa-12](assets/aa-12.png)

また、複数の Analytics 変数を同じ **CQ 変数**&#x200B;にマッピングできます。

![chlimage_1-68](assets/chlimage_1-68.png)

マッピングされたデータは、ページが読み込まれ、次の条件を満たした場合に、Adobe Analytics に送信されます。

* ページがフレームワークに関連付けられています。
* ページでは、フレームワークに追加されたコンポーネントが使用されます。

次の手順を実行して、CQ コンポーネント変数を Adobe Analytics のレポートプロパティにマッピングします。

1. **AEM ビュー**&#x200B;で、サイドキックからフレームワークにトラッキングコンポーネントをドラッグします。例えば、 **ページ** コンポーネント **一般** カテゴリ。

   ![aa-13](assets/aa-13.png)

   デフォルトのコンポーネントグループには、**一般**、**コマース**、**コミュニティ**&#x200B;および&#x200B;**その他**&#x200B;があります。AEM インスタンスは、異なるグループおよびコンポーネントを表示するように設定されていることがあります。

1. Adobe Analytics 変数をコンポーネントで定義された変数にマッピングするには、**Analytics 変数**&#x200B;をコンテンツファインダーからトラッキングコンポーネントのフィールドにドラッグします。たとえば、 `Page Name (pageName)` を `pagedata.title` にドラッグします。

   ![aa-14](assets/aa-14.png)

   >[!NOTE]
   >
   >フレームワーク用に選択されたレポートスイート ID（RSID）によって、コンテンツファインダーに表示される Adobe Analytics 変数が決まります。

1. 他のコンポーネントおよび変数について、前述の 2 つの手順を繰り返します。

   >[!NOTE]
   >
   >複数の Analytics 変数をマッピングできます ( 例： `props`, `eVars`, `events`) を同じ CQ 変数 ( 例えば、 `pagedata.title`)

   >[!CAUTION]
   >
   >次の状態が強く推奨されます。
   >
   >* `eVars` および `props` が `pagedata.X` または `eventdata.X` で始まる CQ 変数にマッピングされること
   >* それに対して、イベントは `eventdata.events.X` で始まる変数にマッピングされる必要があること

1. サイトのパブリッシュインスタンスでフレームワークを使用できるようにするには、サイドキックの「**ページ**」タブを開いて、「**フレームワークをアクティベート**」をクリックします。

## 製品関連変数のマッピング {#mapping-product-related-variables}

AEM は、Adobe Analytics 製品関連プロパティにマッピングされるための製品関連の変数とイベントの命名に規則を使用します。

| CQ 変数 | Analytics 変数 | 説明 |
|--- |--- |--- |
| `product.category` | `product.category`（コンバージョン変数） | 製品カテゴリです。 |
| `product.sku` | `product.sku`（コンバージョン変数） | 製品 SKU です。 |
| `product.quantity` | `product.quantity`（コンバージョン変数） | 購入される製品の数です。 |
| `product.price` | `product.price`（コンバージョン変数） | 製品価格です。 |
| `product.events.<eventName>` | レポートで製品に関連付けるための成功イベントです。 | `product.events` は、*eventName* という名前のイベントのプレフィックスです。 |
| `product.evars.<eVarName>` | 製品に関連付けるためのコンバージョン変数（`eVar`）です。 | `product.evars` は、*eVarName* という名前の eVar 変数のプレフィックスです。 |

いくつかの AEM Commerce コンポーネントは、これらの変数名を使用します。

>[!NOTE]
>
>Adobe Analytics Products プロパティを CQ 変数にマッピングしないでください。この表で説明している製品関連マッピングの設定は、Products 変数へのマッピングと実質的に同じです。

### Adobe Analytics のレポートのチェック {#checking-reports-on-adobe-analytics}

1. AEM に提供されたのと同じ資格情報を使用して Adobe Analytics web サイトにログインします。
1. 選択した RSID が、前の手順で使用したものであることを確認します。
1. （ページの左側の）**レポート**&#x200B;で、**カスタムコンバージョン**／**カスタムコンバージョン 1～10**&#x200B;を選択して、`eVar7` に対応する変数を選択します。

1. 使用しているAdobe Analyticsのバージョンに応じて、使用されている検索語句でレポートが更新されるまで平均 45 分待つ必要があります。例えば、例では、nugplant と指定します。

## Adobe Analytics フレームワークでの Content Finder（cf#）の使用 {#using-the-content-finder-cf-with-adobe-analytics-frameworks}

最初は、Adobe Analytics フレームワークを開くと、コンテンツファインダーに事前定義済みの Analytics 変数が以下に含まれています。

* トラフィック
* コンバージョン
* イベント

RSID が選択されている場合、その RSID に属するすべての変数がリストに追加されます。\
The `cf#` は、異なるトラッキングコンポーネントに存在する CQ 変数に Analytics 変数をマッピングするために必要です。 基本トラッキングのためのフレームワークのセットアップを参照してください。

フレームワーク用に選択したビューに応じて、コンテンツファインダーは、Analytics 変数（AEM ビュー）または CQ 変数（Analytics ビュー）のどちらかによって入力されます。

リストは、次の方法で操作できます。

1. When in **AEM表示**&#x200B;を使用すると、3 つのフィルターボタンを使用して、選択した変数の種類に応じてリストをフィルタリングできます。

   * どのボタンも選択されて&#x200B;*いない*&#x200B;場合、完全なリストが表示されます。
   * 「**トラフィック**」ボタンが選択されている場合、リストには、「トラフィック」セクションに属する変数のみが表示されます。
   * 「**コンバージョン**」ボタンが選択されている場合、リストには「コンバージョン」セクションに属する変数のみが表示されます。
   * 次の場合、 **イベント** ボタンが選択されている場合、リストには「イベント」セクションに属する変数のみが表示されます。

   >[!NOTE]
   >
   >一度に 1 つのフィルターのみアクティブにできます。

   1. また、リストには検索機能があり、検索フィールドに入力されたテキストに従って要素をフィルタリングします。
   1. リスト内の要素の検索中にフィルターオプションが有効になっている場合、表示される結果は、アクティブなボタンに応じてフィルタリングされます。
   1. リストは、渦巻き矢印ボタンを使用して、いつでも再読み込みできます。
   1. フレームワークで複数の RSID が選択されている場合、リスト内のすべての変数が、選択された RSID 内で使用されるすべてのラベルを使用して表示されます。

1. Adobe Analytics ビューの場合、コンテンツファインダーは、CQ ビューでドラッグしたトラッキングコンポーネントに属するすべての CQ 変数を表示します。

   * 例えば、 **コンポーネントをダウンロード** が *ただひたひたひたひたひたす* CQ ビュー内（2 つのマッピング可能な変数を持つ） *eventdata.downloadLink* および *eventdata.events.startDownload*&#x200B;など ) の場合、Adobe Analytics表示に切り替えると、コンテンツファインダーは次のように表示されます。

   ![aa-22](assets/aa-22.png)

   * 変数は、3 つの変数セクション (**トラフィック**, **コンバージョン** および **イベント**) をクリックします。

   * 新しいトラッキングコンポーネントを CQ ビューのフレームワークにドラッグすると、コンポーネントに属する CQ 変数は、Adobe Analytics ビューのコンテンツファインダー（cf#）に自動的に追加されます。

   >[!NOTE]
   >
   >1 つのAdobe Analytics変数にマッピングできる CQ 変数は、いつでも 1 つだけです。

## AEM ビューと Analytics ビューの使用 {#using-aem-view-and-analytics-view}

フレームワークページでのAdobe Analyticsマッピングの表示方法は、いつでも 2 通りに切り替えることができます。 2 つのビューは、2 つの異なる視点から、フレームワーク内のマッピングの概要をより適切に示します。

### AEM View {#aem-view}

![aa-23](assets/aa-23.png)

上記の画像を例として、 **AEM表示** には次のプロパティがあります。

1. これは、フレームワークが開いたときのデフォルトの表示です。
1. 左側：コンテンツファインダー（cf#）には、選択した RSID に基づいて Adobe Analytics 変数が入力されます。
1. タブヘッダー（**AEM ビュー**&#x200B;と **Analytics ビュー**）：2 つのビューを切り替えるのに使用します。

1. **AEM ビュー**:

   1. フレームワークに、親から継承されるコンポーネントが含まれる場合、コンポーネントにマッピングされた変数と共に、ここに一覧表示されます。

      1. 継承されたコンポーネントはロックされます。
      1. 継承されたコンポーネントのロックを解除するには、コンポーネント名の横にある鍵アイコンをダブルクリックします
      1. 継承を元に戻すには、ロック解除されたコンポーネントを削除します。その後、ロックされた状態に戻ります。

   1. **分析フレームワークに含めるには、ここにコンポーネントをドラッグします**：コンポーネントは、Sidekickからドラッグして、ここにドロップできます。
   1. 分析フレームワークに現在含まれているすべてのコンポーネントを検索できます。

      1. コンポーネントを追加するには、サイドキックの「コンポーネント」タブからドラッグします。
      1. コンポーネントとそのすべてのマッピングを削除するには、コンポーネントのコンテキストメニューから「削除」を選択し、確認ダイアログで削除を確定します。
      1. コンポーネントは、作成元のフレームワークからのみ削除でき、従来の意味では子フレームワークからは削除できません（上書きのみ可能です）。

### Analytics ビュー {#analytics-view}

![aa-24](assets/aa-24.png)

1. このビューには、フレームワークの「**Analytics ビュー**」タブに切り替えることでアクセスできます。
1. 左側：CQ ビューのフレームワークにドラッグしたコンポーネントに基づいて CQ 変数によって設定されるコンテンツファインダー (cf#)。
1. タブヘッダー（**AEM ビュー**&#x200B;と **Analytics ビュー**）：2 つのビューを切り替えるのに使用します。

1. 3 つの表（トラフィック、コンバージョン、イベント）には、選択された RSID が属するすべての利用可能な Adobe Analytics 変数がリストされています。選択された RSID に属しています。 ここに表示されるマッピングは、AEMビューと同じである必要があります。

   * **トラフィック**：

      * CQ 変数（`eventdata.downloadLink`）にマッピングされたトラフィック変数（`prop1`）

      * コンポーネントの横に南京錠アイコンがある場合、そのアイコンは親フレームワークから継承されるので、編集できなくなります

   * **コンバージョン**：

      * CQ 変数（`pagedata.title`）にマッピングされたコンバージョン変数（`eVar1`）

      * コンバージョン変数 ( `eVar3`) を JavaScript 式にマッピングするために使用されます。インラインで追加するには、CQ 変数フィールドをダブルクリックし、コードを手動で入力します。

   * **イベント**：

      * CQ イベント（`eventdata.events.pageView`）にマッピングされたイベント変数（`event1`）

>[!NOTE]
>
>任意のテーブルの CQ 変数列も、フィールドをダブルクリックしてテキストを追加することで、インラインで入力できます。 これらのフィールドは JavaScript を入力として受け付けます。
>
>例えば、`prop3` の隣に 以下を追加できます。
>     `'`* `Adobe:'+pagedata.title+':'+pagedata.sitesection`\
これで、*:*（コロン）を使用し、`prop3` として *Adobe* を接頭辞として使用して、*サイトセクション*&#x200B;と連結されたページの&#x200B;*タイトル*&#x200B;を送信します
>

>[!CAUTION]
>
1 つのAdobe Analytics変数にマッピングできる CQ 変数は、いつでも 1 つだけです。
