---
title: アダプティブフォームフラグメント
seo-title: Adaptive form fragments
description: アダプティブフォームは、任意のアダプティブフォーム内で使用する際に、パネルやフィールドのグループなどのフォームセグメントを作成するメカニズムを提供します。 また、既存のパネルをフラグメントとして保存することもできます。
seo-description: Adaptive forms provides a mechanism to create a form segment, such as a panel or a group of fields, as use it in any adaptive form. You can also save an existing panel as fragment.
uuid: bb4830b5-82a0-4026-9dae-542daed10e6f
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: author
discoiquuid: 1a32eb24-db3b-4fad-b1c7-6326b5af4e5e
docset: aem65
feature: Adaptive Forms
exl-id: 2f276e9d-b3c1-48f7-a94a-bdf7eb15a031
source-git-commit: 50d29c967a675db92e077916fb4adef6d2d98a1a
workflow-type: tm+mt
source-wordcount: '2111'
ht-degree: 34%

---

# アダプティブフォームフラグメント{#adaptive-form-fragments}

<span class="preview"> Adobeでは、最新の拡張可能なデータキャプチャを使用することをお勧めします [コアコンポーネント](https://experienceleague.adobe.com/docs/experience-manager-core-components/using/adaptive-forms/introduction.html?lang=ja) 対象： [新しいアダプティブFormsの作成](/help/forms/using/create-an-adaptive-form-core-components.md) または [AEM SitesページへのアダプティブFormsの追加](/help/forms/using/create-or-add-an-adaptive-form-to-aem-sites-page.md). これらのコンポーネントは、アダプティブFormsの作成における大幅な進歩を表し、印象的なユーザーエクスペリエンスを実現します。 この記事では、基盤コンポーネントを使用してアダプティブFormsを作成する古い方法について説明します。 </span>

すべてのフォームは特定の目的用に設計されますが、ほとんどのフォームには、いくつかの共通するセグメントがあります（例：名前と住所、家族の詳細、収入の詳細などの個人情報などを入力するためのセグメント）。フォーム開発者は、新しいフォームを作成するたびに、これらの共通セグメントを作成する必要があります。

アダプティブフォームは、パネルやフィールドのグループのようなフォームセグメントを 1 回だけ作成し、アダプティブフォーム間で再利用する便利なメカニズムです。 これらの再利用可能でスタンドアロンのセグメントは、アダプティブフォームフラグメントと呼ばれます。

## フラグメントの作成 {#create-a-fragment}

アダプティブフォームフラグメントは、最初から作成することも、パネルを既存のアダプティブフォーム内にフラグメントとして保存することもできます。

### フラグメントを最初から作成 {#create-fragment-from-scratch}

1. AEM Forms オーサーインスタンス（https://[*hostname*]:[*port*]/aem/forms.html）にログインします。
1. クリック **作成/アダプティブフォームフラグメント**.
1. フラグメントのタイトル、名前、説明およびタグを指定します。

   >[!NOTE]
   >
   >フラグメントには一意の名前を指定してください。 同じ名前の別のフラグメントが既に存在する場合、フラグメントの作成に失敗します。

1. 「**フォームモデル**」タブをクリックして開き、「**次から選択**」ドロップダウンメニューから、フラグメントに対して次のいずれかのモデルを選択します。

   * **なし**：フォームモデルを使用しないで最初からフラグメントを作成するときに指定します。
   * **フォームテンプレート**:AEM Formsにアップロードされた XDP テンプレートを使用してフラグメントを作成する場合に指定します。 フラグメントのフォームモデルとして適当な XDP テンプレートを選択してください。

   ![フォームテンプレートをモデルとして使用したアダプティブフォームの作成](assets/form-template-model.png)

   選択したフォームテンプレート内でフラグメントとしてマークされたサブフォームも表示されます。ドロップダウンリストから、アダプティブフォームフラグメントのサブフォームを選択できます。

   ![指定したフォームテンプレートからサブフォームを選択する](assets/fragment-subform.png)

   さらに、ドロップダウンボックスでサブフォームの SOM 式を指定することで、フォームテンプレートでフラグメントとしてマークされていないサブフォームを使用して、アダプティブフォームフラグメントを作成できます。

   * **XML スキーマ**:AEM Formsにアップロードされた XML スキーマを使用してフラグメントを作成する場合に指定します。 フラグメントのフォームモデルとして使用可能な XML スキーマからアップロードまたは選択できます。

   ![モデルとして XML スキーマに基づいてアダプティブフォームフラグメントを作成](assets/xml-schema-model.png)

   ドロップダウンボックスから選択されたスキーマにある complexType を選択することで、アダプティブフォームフラグメントを作成することもできます。

   ![指定した XML スキーマモデルから複合タイプを選択する](assets/complex-type.png)

1. 「**作成**」をクリックし、次に「**開く**」をクリックして、編集モードでデフォルトテンプレートを使ってフラグメントを開きます。

編集モードでは、アダプティブフォームコンポーネントをAEMサイドキックからフラグメントにドラッグ&amp;ドロップできます。 アダプティブフォームのコンポーネントについて詳しくは、 [アダプティブフォームのオーサリングの概要](../../forms/using/introduction-forms-authoring.md).

また、フラグメントのフォームモデルとして XML スキーマまたは XDP フォームテンプレートを選択した場合は、フォームモデル階層を示す新しいタブがコンテンツファインダーに表示されます。 これにより、フォームモデルの要素をフラグメントにドラッグ&amp;ドロップできます。 追加されたフォームモデル要素はフォームコンポーネントに変換されますが、関連する XDP または XSD の元のプロパティは保持されます。

### パネルをフラグメントとして保存 {#save-panel-as-a-fragment}

1. アダプティブフォームフラグメントとして保存するパネルが含まれているアダプティブフォームを開きます。
1. パネルツールバーで、 **[!UICONTROL フラグメントとして保存]**. フラグメントとして保存ダイアログが開きます。

   >[!NOTE]
   >
   >フラグメントとして保存しているパネルに子パネルが含まれている場合、結果のフラグメントには子パネルが含まれます。

1. フラグメントの作成ダイアログで、次の情報を指定します。

   * **名前**：フラグメントの名前。 デフォルト値は、パネルの要素名です。 このフィールドは必須です。
     >[!NOTE]
     >
     >フラグメントには一意の名前を指定してください。 同じ名前の別のフラグメントが既に存在する場合、フラグメントの作成に失敗します。

   * **タイトル**：フラグメントのタイトル。デフォルト値はパネルのタイトルです。

   * **説明**：フラグメントの説明。

   * **タグ**：フラグメントのタグメタデータ。

   * **ターゲットパス**：フラグメントが保存されるリポジトリーパス。パスを指定しない場合、フラグメントと同じ名前のノードが、アダプティブフォームを含むノードの横に作成されます。 フラグメントはこのノードに保存されます。

   * **フォームモデル**：アダプティブフォームのフォームモデルに応じて、このフィールドには **XML スキーマ**, **フォームテンプレート**&#x200B;または **なし**. このフィールドは編集できません。

   * **フラグメントモデルのルート**:XSD ベースのアダプティブフォームにのみ表示されます。 フラグメントモデルのルートを指定します。 次を選択できます。 **/** または XSD 複合タイプをドロップダウンから選択します。 フラグメントを別のアダプティブフォームで再利用できるのは、複合タイプをフラグメントモデルルートとして選択した場合のみです。**/** をフラグメントモデルルートとして選択した場合、ルートからの完全な XSD ツリーは、「アダプティブフォームデータモデル」タブに表示されます。複合タイプのフラグメントモデルルートの場合、選択した複合タイプの子孫のみが、「アダプティブフォームデータモデル」タブに表示されます。

   * **XSD 参照**：XSD ベースのアダプティブフォームにのみ表示されます。XML スキーマの場所を表示します。

   * **XDP 参照**:XDP ベースのアダプティブフォームにのみ表示されます。 XDP フォームテンプレートの場所を表示します。

   ![save-fragment](assets/save-fragment.png)

   フラグメントとして保存ダイアログ

1. 「**OK**」をクリックします。

   パネルがリポジトリー内の指定した場所またはデフォルトの場所に保存されます。アダプティブフォームでは、パネルがフラグメントのスナップショットに置き換えられます。 以下に示すように、一般情報パネルとその子パネル（個人情報と住所）はフラグメントとして保存されます。

   フラグメントを編集するには、 **[!UICONTROL アセットを編集]** 」と入力します。 フラグメントが新しいタブまたはウィンドウで編集モードで開きます。

   ![フラグメントの編集](assets/edit-fragment.png)

## フラグメントの操作 {#working-with-fragments}

### フラグメントの外観の設定 {#configure-fragment-appearance}

アダプティブフォーム内に挿入したフラグメントは、プレースホルダー画像として表示されます。 プレースホルダーには、フラグメント内の子パネルのタイトルが最大 10 個まで表示されます。プレースホルダーの画像の代わりに完全なフラグメントを表示するようにAEM Formsを設定できます。

次の手順を実行して、フォームのフラグメントをすべて表示します。

1. AEM Web コンソールの設定ページ（https:[*host*]:[*port*]/system/console/configMgr）に移動します。

1. **[!UICONTROL アダプティブフォームとインタラクティブ通信の web チャネル設定]**&#x200B;を検索およびクリックして、編集モードで開きます。
1. 無効にする **[!UICONTROL フラグメントの代わりにプレースホルダーを有効にする]** チェックボックスをオンにして、プレースホルダー画像ではなく完全なフラグメントを表示します。

### アダプティブフォームにフラグメントを挿入する {#insert-a-fragment-in-an-adaptive-form}

作成したアダプティブフォームフラグメントは、AEMコンテンツファインダーの「アダプティブフォームフラグメント」タブに表示されます。 アダプティブフォームフラグメントをアダプティブフォームに挿入するには、次の手順を実行します。

1. アダプティブフォームフラグメントを挿入するアダプティブフォームを編集モードで開きます。
1. サイドバーの「**Assets** ![assets-browser](assets/assets-browser.png)」をクリックします。アセットブラウザーで、ドロップダウンリストから「**アダプティブフォームフラグメント**」を選択します。

   すべてのアダプティブフォームフラグメントを表示するか、フォームモデル（フォームテンプレート、XML スキーマ、基本）に基づいてフィルターするかを選択することもできます。

1. アダプティブフォームフラグメントをアダプティブフォームにドラッグ&amp;ドロップします。

   >[!NOTE]
   >
   >アダプティブフォームフラグメントは、アダプティブフォーム内からのオーサリングでは有効になっていません。 また、JSON ベースのアダプティブフォームでは、XSD ベースのフラグメントを使用することも、その逆の方法で使用することもできません。

アダプティブフォームフラグメントは、アダプティブフォーム内の参照によって挿入され、スタンドアロンのアダプティブフォームフラグメントと同期されます。 つまり、アダプティブフォームフラグメントを更新すると、その変更が、フラグメントが使用されているすべてのアダプティブフォームに反映されます。

### フラグメントをアダプティブフォームに埋め込む {#embed-a-fragment-in-adaptive-form}

アダプティブフォーム内にアダプティブフォームフラグメントを埋め込むには、 **埋め込みアセット： &lt;*fragmentName*>** ボタンを使用して、追加されたフラグメントのパネルツールバーを表示できます（次の例を参照）。

![フォームフラグメントのアダプティブフォーム内への埋め込み](assets/embed-fragment.png)

>[!NOTE]
>
>埋め込まれたフラグメントは、スタンドアロンのフラグメントとリンクされなくなりました。埋め込まれたフラグメント内のコンポーネントは、アダプティブフォーム内から編集できます。

### フラグメント内でのフラグメントの使用 {#using-fragments-within-fragments}

ネストされたアダプティブフォームフラグメントを作成できます。つまり、別のフラグメント内にフラグメントをドラッグ&amp;ドロップし、ネストされたフラグメント構造を持つことができます。

### フラグメントの変更 {#change-fragments}

アダプティブフォームフラグメントを別のフラグメントで置き換えたり変更したりするには、 **フラグメントアセットを選択** プロパティを編集して、アダプティブフォームフラグメントパネル用のコンポーネントを編集ダイアログに表示します。

## データ連結のためのフラグメントの自動マッピング {#auto-mapping-of-fragments-for-data-binding}

XFA フォームテンプレートまたは XSD 複合タイプを使用してアダプティブフォームフラグメントを作成し、フラグメントをアダプティブフォームにドラッグ&amp;ドロップすると、XFA フラグメントまたは XSD 複合タイプは、フラグメントモデルルートが XFA フラグメントまたは XSD 複合タイプにマッピングされる対応するアダプティブフォームフラグメントに自動的に置き換えます。

コンポーネントの編集ダイアログから、フラグメントアセットとその連結を変更できます。

>[!NOTE]
>
>AEMコンテンツファインダーのアダプティブフォームフラグメントライブラリから連結されたアダプティブフォームフラグメントをドラッグ&amp;ドロップし、アダプティブフォームフラグメントパネルの編集コンポーネントダイアログから正しい連結参照を提供することもできます。

## フラグメントの管理 {#manage-fragments}

AEM Forms UI を使用して、アダプティブフォームフラグメントに対して複数の操作を実行できます。

1. `https://[hostname]:'port'/aem/forms.html` にアクセスします。

1. クリック **選択** AEM Forms UI ツールバーで、アダプティブフォームフラグメントを選択します。 ツールバーには、選択したアダプティブフォームフラグメントに対して実行できる次の操作が表示されます。

<table>
 <tbody>
  <tr>
   <td><p><strong>操作</strong></p> </td>
   <td><p><strong>説明</strong></p> </td>
  </tr>
  <tr>
   <td><p>次を開きます：</p> </td>
   <td><p>選択したアダプティブフォームフラグメントを編集モードで開きます。<br /> <br /> </p> </td>
  </tr>
  <tr>
   <td><p>プロパティを表示</p> </td>
   <td><p>プロパティパネルを開きます。 プロパティパネルから、プロパティの表示と編集、プレビューの生成、選択したフラグメントのサムネール画像のアップロードをおこなうことができます。 詳しくは、「<a href="../../forms/using/manage-form-metadata.md" target="_blank">メタデータの管理</a>」を参照してください。<br /> <br /> </p> </td>
  </tr>
  <tr>
   <td><p>コピー</p> </td>
   <td><p>選択したフラグメントをコピーします。 貼り付けボタンがツールバーに表示されます。<br /> <br /> </p> </td>
  </tr>
  <tr>
   <td><p>ダウンロード</p> </td>
   <td><p>選択されているフラグメントをダウンロードします。<br /> <br /> </p> </td>
  </tr>
  <tr>
   <td><p>プレビュー</p> </td>
   <td><p>フラグメントを HTML でプレビューするか、あるいは XML ファイルからのデータをフラグメントとマージしてカスタムプレビューを生成するかのオプションが与えられます。詳しくは、 <a href="/help/forms/using/previewing-forms.md" target="_blank">フォームのプレビュー</a>.<br /> <br /> </p> </td>
  </tr>
  <tr>
   <td><p>レビューの開始／レビューの管理</p> </td>
   <td><p>選択されているフラグメントのレビューを開始したり管理したりできます。詳しくは、 <a href="../../forms/using/create-reviews-forms.md" target="_blank">レビューの作成と管理</a>.<br /> <br /> </p> </td>
  </tr>
  <tr>
   <td><p>辞書の作成</p> </td>
   <td><p>選択されているフラグメントをローカライズするための辞書を生成します。詳しくは、 <a href="/help/forms/using/lazy-loading-adaptive-forms.md" target="_blank">アダプティブフォームのローカライズ</a>.<br /> <br /> </p> </td>
  </tr>
  <tr>
   <td><p>公開／非公開</p> </td>
   <td><p>選択されているフラグメントを公開／非公開します。<br /> <br /> </p> </td>
  </tr>
  <tr>
   <td><p>削除</p> </td>
   <td><p>選択されているフラグメントを削除します。<br /> <br /> </p> </td>
  </tr>
 </tbody>
</table>

## フラグメントを含むアダプティブフォームのローカライズ {#localizing-adaptive-form-containing-fragments}

アダプティブフォームフラグメントを含むアダプティブフォームをローカライズするには、フラグメントとフォームを別々にローカライズする必要があります。 考え方としては、フラグメントを 1 回ローカライズし、複数のアダプティブフォームで再利用することです。

>[!NOTE]
>
>フラグメント内のローカライゼーションキーは、アダプティブフォームの XLIFF ファイル内には表示されません。

## フラグメントで作業するときの考慮事項 {#key-points-to-remember-when-working-with-fragments}

* フラグメント名が一意であることを確認します。 同じ名前の既存のフラグメントが存在する場合、フラグメントの作成に失敗します。
* XDP ベースのアダプティブフォームで、別の XDP フラグメントを含むフラグメントとしてパネルを保存すると、結果のフラグメントは自動的に子 XDP フラグメントにバインドされます。 XSD ベースのアダプティブフォームでは、生成されるフラグメントはスキーマルートにバインドされます。
* アダプティブフォームフラグメントを作成すると、フラグメントノードが作成されます。これは CRXDE Lite における、アダプティブフォームの guideContainer ノードに類似したものです。
* 異なるフォームデータモデルを使用するアダプティブフォーム内のフラグメントはサポートされていません。 例えば、XDP ベースのフラグメントは XSD ベースのアダプティブフォームではサポートされませんが、その逆も同様です。
* アダプティブフォームフラグメントは、AEMコンテンツファインダーの「アダプティブフォームフラグメント」タブを通じて使用できます。
* スタンドアロンのアダプティブフォームフラグメント内の式、スクリプト、スタイルは、アダプティブフォームに参照によって挿入されたとき、または埋め込まれたときに保持されます。
* アダプティブフォーム内からは、参照によって挿入されたアダプティブフォームフラグメントを編集することはできません。 編集するには、スタンドアロンのアダプティブフォームフラグメントを編集するか、アダプティブフォーム内にフラグメントを埋め込みます。
* アダプティブフォームを発行する場合は、アダプティブフォーム内で参照によって挿入されたスタンドアロンのアダプティブフォームフラグメントを発行する必要があります。
* 更新されたアダプティブフォームフラグメントを再発行すると、その変更は、フラグメントが使用されているアダプティブフォームの発行済みインスタンスに反映されます。
* 検証コンポーネントを含むアダプティブフォームは、匿名ユーザーをサポートしません。 また、アダプティブフォームフラグメントで検証コンポーネントを使用することはお勧めしません。
* （**Mac のみ**）フォームフラグメント機能がすべてのシナリオで正しく動作するようにするには、/private/etc/hosts ファイルに次のエントリを追加します。
  `127.0.0.1 <Host machine>` **ホストマシン**：AEM Forms がデプロイされている Apple Mac マシン。

## リファレンスフラグメント {#reference-fragments}

フォームの作成に使用できる参照用アダプティブフォームフラグメントを使用できます。 詳しくは、[リファレンスフラグメント](../../forms/using/reference-adaptive-form-fragments.md)を参照してください。
