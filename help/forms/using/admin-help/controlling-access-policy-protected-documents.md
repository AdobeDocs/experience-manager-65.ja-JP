---
title: ポリシーで保護されたドキュメントへのアクセス制御
description: ポリシーで保護されたドキュメントへのアクセスを表示、管理、制御する方法を参照してください。
contentOwner: admin
content-type: reference
geptopics: SG_AEMFORMS/categories/working_with_document_security
products: SG_EXPERIENCEMANAGER/6.5/FORMS
feature: Document Security
exl-id: 0eb6e769-97c1-41ee-8d12-91bece984947
solution: Experience Manager, Experience Manager Forms
role: User, Developer
source-git-commit: f6771bd1338a4e27a48c3efd39efe18e57cb98f9
workflow-type: ht
source-wordcount: '2167'
ht-degree: 100%

---

# ポリシーで保護されたドキュメントへのアクセス制御 {#controlling-access-to-policy-protected-documents}

ポリシーで保護されたドキュメントの配布範囲にかかわらず、受信者がそのドキュメントを使用する方法を制御できます。

ドキュメントページでは、以下のタスクを実行できます。

* ポリシーで保護されたドキュメントを検索して詳細を表示します。ドキュメント名、発行者名、ポリシー名およびポリシー適用日に関する情報を表示できます。ドキュメントを保護していたポリシーが削除されると、ポリシー名の下に削除されたポリシー ID も表示されます。ユーザーは、自分のポリシーで保護されたドキュメントを表示および管理できます。管理者は、すべてのポリシーで保護されたドキュメントを表示および管理できます。
* ドキュメントに適用されるポリシーの詳細を変更します。ユーザーは、自分のポリシーを編集できます。管理者は、共有ポリシーと個人用ポリシーを編集できます。ポリシーセットコーディネーターは、権限を持つポリシーセットに含まれる共有ポリシーを編集できます。ドキュメントの詳細ページから、ドキュメントに関連付けられているポリシーに直接アクセスできます。
* ポリシーで保護されたドキュメントへのアクセスを取り消して復元します。管理者は、任意のドキュメントへのアクセスを取り消して復元できます。ポリシーセットコーディネーターは（ドキュメントを管理する権限を持つ場合）、自分のポリシーセットの共有ポリシーで保護されているドキュメントへのアクセスを取り消して復元できます。ユーザーは、ドキュメントを保護するポリシーを作成した場合、またはそのポリシーがこの機能を許可する共有ポリシーである場合、ポリシーで保護されたドキュメントへのアクセスを取り消すことができます。
* ドキュメントに適用されるポリシーを切り替えます。ドキュメントにポリシーを適用するユーザーは、ポリシーを作成した場合、またはこの機能を有効にする共有ポリシーである場合は、ポリシーを切り替えることができます。ポリシーセットコーディネーターは、自分のポリシーセットのポリシーを切り替えることができます。管理者は、すべてのドキュメントに適用されているポリシーを切り替えることができます。

ドキュメントがポリシーで保護されている場合、アクセス権限を取り消すか適用されているポリシーを切り替えると、変更は以下のように反映されます。

* ドキュメントがオンラインの場合は、ユーザーがドキュメントを開いていなければ、変更は直ちに適用されます。ユーザーがドキュメントを開いている場合、変更を有効にするにはユーザーはドキュメントを閉じる必要があります。
* 受信者がドキュメントを（ラップトップコンピューターなどで）オフラインで使用している場合は、次に受信者がポリシーで保護されたドキュメントを開くことによって Document Security と同期させるときに変更が有効になります。

## ドキュメントに関する情報を表示する {#view-information-about-a-document}

ドキュメントページに表示されるドキュメントごとに、そのドキュメント名、発行者名、ポリシー名およびドキュメントが保護された日付が表示されます。ドキュメントを保護していたポリシーが削除されると、「ポリシー名」の下に削除されたポリシー ID が表示されます。

特定のドキュメントに関する詳細情報（下記の説明を参照）を、ドキュメントの詳細ページに表示することもできます。

>[!NOTE]
>
>メールに添付されたドキュメントの受信者用に Microsoft Outlook で自動生成されるポリシーにアクセスするには、ドキュメントの詳細ページの「ポリシー名」リンクを使用します。これらのポリシーは、ポリシーページには表示されません。

**ドキュメント名：**&#x200B;選択したドキュメントの名前

**ドキュメント ID：**&#x200B;ドキュメントにポリシーが適用されるときに Document Security がよって割り当てる一意の識別子。Document Security では、この番号を使用してドキュメントが追跡されます。

**ドキュメントのステータス：**&#x200B;ドキュメントのステータス（アクティブ、失効など）

**発行者：**&#x200B;ポリシーをドキュメントに添付したユーザーの名前

**ポリシー名：**&#x200B;ドキュメントを保護するために使用されるポリシーの名前名前をクリックしてポリシーを開くことができます。Outlook のメールに添付されたドキュメントの受信者用に Acrobat で生成されるポリシーにアクセスするには、このリンクを使用します。これらのポリシーは、ポリシーページには表示されません。

**ポリシータイプ：**&#x200B;ドキュメントに適用されたポリシーのタイプ

**発行日：**&#x200B;ポリシーがドキュメントに適用された日付

**関連する繰り返し：**&#x200B;ドキュメントに関連する繰り返しがある場合、この項目もリストに表示されます。ドキュメントの関連する繰り返しのリストを表示するには、そのリンクをクリックします。

ユーザーは、自分の保護されたドキュメントに関する情報を表示できます。管理者は、ユーザーがポリシーで保護しているドキュメントに関する情報を表示できます。ポリシーセットコーディネーターは、自分のポリシーセットのポリシーで保護されているドキュメントに関する情報を表示できます。

1. Document Security ページで、「ドキュメント」をクリックします。
1. ドキュメントのリストで、目的のドキュメントをクリックします。ドキュメントの詳細ページが開き、ドキュメントに関する詳細情報が表示されます。このページには、ドキュメントのアクセスの取り消し、ポリシーの切り替えおよびこのドキュメントに関連するイベントの表示のオプションも用意されています。

## ドキュメントの関連する繰り返しを表示する {#view-related-iterations-for-a-document}

関連する繰り返しの追跡が有効になっている場合、様々なユーザーが保存したドキュメントのバージョンを追跡できます。この機能は、PTC Pro/ENGINEER Wildfire などの特定のアプリケーションでのみサポートされます。

この機能は、複数のユーザーがコラボレーションしていて、同じドキュメントの異なるバージョンを保存する場合に便利です。Document Security では、様々な繰り返しを追跡記録できるので、様々なバージョンのドキュメント情報を簡単に表示できます。

この機能が有効になっている場合、ドキュメントページからドキュメントの関連する繰り返しを表示できます。

1. ドキュメントのドキュメント詳細ページを表示します（[ドキュメントに関する情報の表示](controlling-access-policy-protected-documents.md#view-information-about-a-document)を参照）。
1. 「関連する繰り返しを表示」をクリックします。このオプションは、機能が有効になっている場合にのみ使用できます。関連する反復のリストが表示されます。反復ごとに、次の情報が表示されます。

   * **繰り返し：**&#x200B;ファイル名。元のファイル名とは異なる場合があり、末尾にバージョン番号が付加されています。
   * **公開者：**&#x200B;元のドキュメントの公開者。
   * **作成者：**&#x200B;繰り返しを保存したユーザー。
   * **作成日：**&#x200B;繰り返しが保存された日付と時刻。
   * **ポリシー：**&#x200B;繰り返しを保護するポリシー。反復によっては異なるポリシーで保護される場合があります。

1. 反復のドキュメント詳細ページを表示するには、その反復のファイル名をクリックします。

## ドキュメントへのアクセス権限の失効および復元 {#revoking-and-reinstating-access-to-documents}

ポリシーで保護されたドキュメントへのアクセス権限を失効および復元できます。

**ユーザー：**&#x200B;ドキュメントがユーザーの個人用ポリシーで保護されている場合、またはポリシーを適用するユーザーに対するポリシーの失効機能が有効になっている共有ポリシーで保護されている場合は、そのドキュメントへのアクセス権限を失効および復元できます。ドキュメントのアクセス権限を失効させることができない場合またはポリシーを切り替えることができない場合は、管理者に問い合わせてください。

**管理者：**&#x200B;個人用または共有ポリシーで保護されたドキュメントなど、ポリシーで保護されたすべてのドキュメントへのアクセス権限を失効および復元できます。共有ポリシーで保護されたドキュメントのアクセス権限を失効させたのが管理者の場合、そのドキュメントのアクセス権限を復元できるのは管理者だけです。

**ポリシーセットコーディネーター：**&#x200B;ポリシーセットのポリシーで保護されたドキュメントのアクセス権限を失効および復元できます。

ドキュメントのアクセス権限を失効または復元すると、その変更は、次のタイミングで反映されます。

* ドキュメントがオンラインで閉じている場合は、ポリシーで保護された任意のドキュメントを受信者が次回オンラインで開いたときに、Document Security との同期が行われて変更が反映されます。
* ドキュメントがオンラインで開いている場合は、受信者がドキュメントを閉じると変更が反映されます。
* ドキュメントがオフラインの場合（インターネットに接続せずにノート PC などで使用している場合）は、次に受信者が Document Security と同期したときに変更が反映されます。

**ポリシーで保護されたドキュメントへのアクセス権限の失効**

1. Document Security ページで、「ドキュメント」をクリックします。
1. 目的のドキュメントの横のチェックボックスをオンにし、「失効」をクリックします。同時に複数のドキュメントへのアクセス権限を失効させることができます。
1. 失効後にドキュメントを開こうとするユーザーに対して表示するメッセージを選択します。

   * **一般メッセージ：**&#x200B;作成者がドキュメントへのアクセス権限を失効させたことを示します。
   * **終了したドキュメント：**&#x200B;作成者がドキュメントを終了したことを示します。
   * **改訂済みのドキュメント：**&#x200B;作成者がドキュメントを改訂したことを示します。

1. （オプション）新バージョンのドキュメントを使用できる場合は、URL を入力し、「テスト」をクリックして URL を確認します。
1. 「OK」をクリックし、再び「OK」をクリックして、ドキュメントページに戻ります。

**ドキュメントのアクセス権限を復元**

1. Document Security ページで、「ドキュメント」をクリックします。
1. ドキュメントのリストで、目的のドキュメントをクリックします。
1. 「失効取り消し」をクリックし、「OK」をクリックします。

## ドキュメントに適用されるポリシーを切り替え {#switch-a-policy-that-is-applied-to-a-document}

ユーザー、ポリシーセットコーディネーターおよび管理者は、ポリシーで保護されたドキュメントに適用されるポリシーを切り替えることができます（ドキュメントには一度に 1 つのポリシーのみを適用できます）。ユーザーは、ポリシーが自分で作成したものである場合、またはポリシーの切り替えが有効化されている共有ポリシーである場合に、ポリシーで保護されたドキュメントに適用されるポリシーを切り替えることができます。それ以外の場合は、管理者またはポリシーセットコーディネーターがポリシーを切り替える必要があります。管理者は、ユーザーのポリシーで保護されたドキュメントのポリシーを切り替えることができます。ポリシーセットコーディネーターは、自分のポリシーセットのポリシーを切り替えることができます。

ポリシーを切り替えると、新しいポリシーは以下のように適用されます。

* ドキュメントがオンラインで閉じている場合は、次回受信者がポリシーで保護された任意のドキュメントをオンラインで開いたとき、ドキュメントセキュリティとの同期が行われて変更が反映されます。
* ドキュメントがオンラインで開いている場合は、ユーザーがドキュメントを閉じると変更が反映されます。
* ドキュメントがオフライン（ラップトップコンピューターなど、アクティブなインターネットまたはネットワーク接続なしで使用されている）の場合は、次回ユーザーがポリシーで保護された任意のドキュメントをオンラインで開いたとき、ドキュメントセキュリティとの同期が行われて変更が反映されます。

>[!NOTE]
>
>現在このアクセス権を持たないポリシーで保護されたドキュメントへの匿名アクセスを許可するには、クライアントアプリケーション内の既存ポリシーを削除してから、匿名アクセスを許可するポリシーを適用します。ポリシーを切り替えても、ユーザーはドキュメントにアクセスするためにログインする必要があります。

1. Document Security ページで、「ドキュメント」をクリックします。
1. ドキュメントのリストで、目的のドキュメントをクリックします。
1. 「ポリシーの切り替え」をクリックします。最大 100 個のポリシーが含まれるリストが表示されます。
1. 目的のポリシーが表示されない場合は、検索リストで「ポリシー名」または「ポリシー ID」を選択し、名前または ID を入力して、「検索」をクリックします。
1. リストから新しいポリシーをクリックします。
1. 「ポリシーの切り替え」をクリックし、「OK」をクリックして、ドキュメントページに戻ります。

## ドキュメントの検索 {#search-for-a-document}

ドキュメントページでは、日付範囲の条件と、リストに示されている検索条件を組み合わせて、ドキュメントを検索できます。これらの条件には、ドキュメント名、ポリシー名またはすべてのドキュメントが含まれます。

管理者だけが使用できる追加の検索オプションを次に示します。

**ドキュメント ID：**&#x200B;ポリシーが適用されるときに Document Security によってドキュメントに割り当てられる一意の ID 番号。

**ドキュメント名：**&#x200B;ドキュメントの名前

**発行者名：**&#x200B;ポリシーをドキュメントに添付したユーザーの名前すべてのドメインまたは指定したドメインからユーザーを選択できます。

**ポリシー ID：**&#x200B;ドキュメントに添付されているポリシーの ID 番号

**ポリシー名：**&#x200B;ドキュメントに添付されているポリシーの名前

**すべてのドキュメント：**&#x200B;管理者およびユーザーによって保護されるすべてのドキュメント「すべてのドキュメント」オプションを使用して検索すると、ドキュメントの長いリストが返される場合があります。

1. Document Security ページで、「ドキュメント」をクリックします。
1. 検索リストで、必要な検索条件を選択します。

   条件には、ドキュメント ID、ドキュメント名、発行者名、ポリシー ID、ポリシー名またはすべてのドキュメントを指定できます。

   発行者名を指定する場合は、アドレス帳アイコンをクリックし、ユーザーを検索するドメインを指定し、「OK」をクリックしてドキュメント検索ページに戻ります。

1. （オプション）日付リストから、日付範囲のオプションを選択します。「カスタム日付」を選択し、表示されるボックスに yyyy/mm/dd の形式で日付を入力します。または、次のように日付選択を使用して日付範囲を指定します。

   * カレンダーをクリックすると、日付選択が開きます。
   * 矢印を使用して、該当する年と月を探します。
   * カレンダー上の日付をクリックします。
   * 「OK」をクリックすると、日付選択が閉じます。

1. 「検索」をクリックします。

## ドキュメントリストの並べ替え {#sort-the-document-list}

列見出しでドキュメントのリストを並べ替えできます。列見出しの横の三角形のアイコンは、現在並べ替えに使用されている列を表します。上向きの三角形は昇順を、下向きの三角形は降順を示しています。

1. Document Security ページで、「ドキュメント」をクリックします。
1. 該当する列見出しをクリックします。
1. ソート順を変更するには、列を再びクリックします。

## ポリシーで保護されたドキュメントへの表紙の追加 {#add-cover-page-to-policy-protected-documents}

アドビ以外の PDF ビューアがほとんどの場合、ドキュメントセキュリティで保護されたドキュメントを開くと、最初のページが空白ページとして表示されるか、アプリケーションがドキュメントを開かずに中止されます。

ページ 0（ラッパードキュメント）サポートを使用してアドビ以外の PDF ビューアで保護されたドキュメントを開き、ドキュメントの表紙を表示できます。

>[!NOTE]
>
>Adobe Reader／Acrobat または Mobile Reader で（ページ 0 を含む）このようなドキュメントを表示する場合、デフォルトで保護されたドキュメントが開かれます。

**ポリシーで保護されたドキュメントに表紙を追加するには**

Workbench で次のプロセスを使用します。

**表紙付きの
ドキュメントの保護：**&#x200B;指定されたポリシーでPDF ドキュメントを保護し、ドキュメントに表紙を追加

**保護されたドキュメントを抽出：**&#x200B;ポリシーで保護された PDF ドキュメントを表紙付きの PDF ドキュメントから抽出

次の Document Security API を使用します。

**protectDocumentWithCoverPage：**特定の PDF を指定したポリシーで保護し、表紙付きのドキュメントと保護されたドキュメントを添付ファイルとして返します
`//Create a ServiceClientFactory instance ServiceClientFactory factory = ServiceClientFactory.createInstance(connectionProps); //Create a RightsManagementClient object RightsManagementClient rightsClient = new RightsManagementClient(factory); //Reference a PDF document to which a policy is applied FileInputStream fileInputStream = new FileInputStream("C:\\testFile.pdf"); Document inPDF = new Document(fileInputStream); //Reference a Cover Page document FileInputStream coverPageInputStream = new FileInputStream("C:\\CoverPage.pdf"); Document inCoverDoc = new Document(coverPageInputStream); //Create a Document Manager object DocumentManager documentManager = rightsClient.getDocumentManager(); //Apply a policy to the PDF document RMSecureDocumentResult rmSecureDocument = documentManager.protectDocumentWithCoverPage( inPDF, "ProtectedPDF.pdf", "PolicySetName", "PolicyName", null, null, inCoverDoc, true); //Retrieve the policy-protected PDF document Document protectPDF = rmSecureDocument.getProtectedDoc(); //Save the policy-protected PDF document File myFile = new File("C:\\PolicyProtectedDoc.pdf"); protectPDF.copyToFile(myFile);` **extractProtectedDocument：**表紙付きのドキュメント内の添付ファイルである保護されたドキュメントを抽出します。表紙付きのドキュメントは protectDocumentWithCoverPage メソッドを使用して作成されます
`//Create a ServiceClientFactory instance ServiceClientFactory factory = ServiceClientFactory.createInstance(connectionProps); //Create a RightsManagementClient object RightsManagementClient rightsClient = new RightsManagementClient(factory); //Reference a protected PDF document with a Cover Page FileInputStream fileInputStream = new FileInputStream("C:\\policyProtectedDocWithCoverPage.pdf"); Document inPDF = new Document(fileInputStream); //Create a Document Manager object DocumentManager documentManager = rightsClient.getDocumentManager(); //Apply a policy to the PDF document Document extractedDoc = documentManager.extractProtectedDocument(inPDF); //Save the policy-protected PDF document File myFile = new File("C:\\PolicyProtectedDoc.pdf"); extractedDoc.copyToFile(myFile);`
