---
title: ポリシーで保護されたドキュメントへのアクセス制御
seo-title: ポリシーで保護されたドキュメントへのアクセス制御
description: ポリシーで保護されたドキュメントへのアクセスを表示、管理、制御する方法を確認してください。
seo-description: ポリシーで保護されたドキュメントへのアクセスを表示、管理、制御する方法を確認してください。
uuid: 2d9f95e9-e4ee-47e2-988e-a191d1d1d264
contentOwner: admin
content-type: reference
geptopics: SG_AEMFORMS/categories/working_with_document_security
products: SG_EXPERIENCEMANAGER/6.5/FORMS
discoiquuid: f34058c3-384a-4b73-a386-5bc9125acbf8
translation-type: tm+mt
source-git-commit: a3c303d4e3a85e1b2e794bec2006c335056309fb
workflow-type: tm+mt
source-wordcount: '2188'
ht-degree: 85%

---


# ポリシーで保護されたドキュメントへのアクセス制御 {#controlling-access-to-policy-protected-documents}

ポリシーで保護されたドキュメントの配布範囲にかかわらず、受信者がそのドキュメントを使用する方法を制御できます。

ドキュメントページでは、以下のタスクを実行できます。

* ポリシーで保護されたドキュメントの検索および詳細の表示。ドキュメント名、発行者名、ポリシー名およびポリシー適用日に関する情報を表示できます。ドキュメントを保護していたポリシーが削除されると、ポリシー名の下に削除されたポリシー ID も表示されます。ユーザーは、自分のポリシーで保護されたドキュメントを表示および管理できます。管理者は、すべてのポリシーで保護されたドキュメントを表示および管理できます。
* ドキュメントに適用されるポリシーの詳細の変更。ユーザーは、自分のポリシーを編集できます。管理者は、共有ポリシーと個人用ポリシーを編集できます。ポリシーセットコーディネーターは、権限を持つポリシーセットに含まれる共有ポリシーを編集できます。ドキュメントの詳細ページから、ドキュメントに関連付けられているポリシーに直接アクセスすることもできます。
* ポリシーで保護されたドキュメントへのアクセス権限の失効および復元。管理者は、任意のドキュメントのアクセス権限を失効および復元できます。ポリシーセットコーディネーターは（ドキュメントを管理する権限を持つ場合）、自分のポリシーセットの共有ポリシーで保護されているドキュメントのアクセス権限を失効および復元できます。ユーザーは、ドキュメントを保護しているポリシーを自分で作成した場合や、ドキュメントを保護しているポリシーがアクセス権限の取り消しを許可する共有ポリシーの場合は、そのポリシーで保護されたドキュメントへのアクセス権限を失効させることができます。
* ドキュメントに適用されるポリシーの切り替え。ドキュメントにポリシーを適用したユーザーは、そのポリシーを自分で作成した場合や、そのポリシーがポリシーの切り替えを許可する共有ポリシーの場合は、ポリシーを切り替えることができます。ポリシーセットコーディネーターは、自分のポリシーセットのポリシーを切り替えることができます。管理者は、すべてのドキュメントに適用されているポリシーを切り替えることができます。

ドキュメントがポリシーで保護されている場合、アクセス権限を失効させるか適用されているポリシーを切り替えると、変更は以下のように反映されます。

* ドキュメントがオンラインの場合は、ユーザーがドキュメントを開いていなければ、変更は直ちに適用されます。ユーザーがドキュメントを開いている場合、変更を有効にするにはユーザーはドキュメントを閉じる必要があります。
* 受信者がドキュメントを（ラップトップコンピューターなどで）オフラインで使用している場合は、次に受信者がポリシーで保護されたドキュメントを開くことによって Document Security と同期させるときに変更が有効になります。

## ドキュメントに関する情報の表示  {#view-information-about-a-document}

ドキュメントページに表示されるドキュメントごとに、そのドキュメント名、発行者名、ポリシー名およびドキュメントが保護された日付が表示されます。ドキュメントを保護していたポリシーが削除されると、「ポリシー名」の下に削除されたポリシー ID が表示されます。

特定のドキュメントに関する詳細情報（下記の説明を参照）を、ドキュメントの詳細ページに表示することもできます。

>[!NOTE]
>
>電子メールに添付されたドキュメントの受信者用に Microsoft Outlook で自動生成されるポリシーにアクセスするには、ドキュメントの詳細ページの「ポリシー名」リンクを使用する必要があります。これらのポリシーは、ポリシーページには表示されません。

**ドキュメント名：** 選択したドキュメントの名前。

**ドキュメントID:ドキュメント** セキュリティがドキュメントにポリシーを適用するときに割り当てる一意の識別子。Document Security では、この番号を使用してドキュメントが追跡されます。

**ドキュメントステータス：ドキュメントの** ステータス（アクティブ、失効など）。

**発行者：ドキュメントにポリシーを適用したユーザーの** 名前。

**Policy Name:** ドキュメントの保護に使用するポリシーの名前。名前をクリックしてポリシーを開くことができます。Outlook の電子メールに添付されたドキュメントの受信者用に Acrobat で生成されるポリシーにアクセスするには、このリンクを使用する必要があります。これらのポリシーは、ポリシーページには表示されません。

**Policy Type:** ドキュメントに適用されたポリシーの種類です。

**発行日：** ポリシーがドキュメントに適用された日付。

**関連する繰り返し：** ドキュメントに関連する繰り返しがある場合は、この項目もリストに表示されます。ドキュメントの関連する繰り返しのリストを表示するには、そのリンクをクリックします。

ユーザーは、自分の保護されたドキュメントに関する情報を表示できます。管理者は、ユーザーがポリシーで保護しているドキュメントに関する情報を表示できます。ポリシーセットコーディネーターは、自分のポリシーセットのポリシーで保護されているドキュメントに関する情報を表示できます。

1. Document Security ページで、「ドキュメント」をクリックします。
1. ドキュメントのリストで、目的のドキュメントをクリックします。ドキュメントの詳細ページが開き、ドキュメントに関する詳細情報が表示されます。このページには、ドキュメントのアクセス権限の失効、ポリシーの切り替えおよびこのドキュメントに関連するイベントの表示のオプションも用意されています。

## ドキュメントの関連する繰り返しの表示  {#view-related-iterations-for-a-document}

関連する繰り返しの追跡が有効になっている場合、あるドキュメントの様々なユーザーが保存したバージョンを追跡できます。この機能は、PTC Pro/ENGINEER Wildfire などの特定のアプリケーションでのみサポートされます。

この機能は、複数のユーザーがコラボレーションしていて、同じドキュメントの異なるバージョンを保存する場合に便利です。Document Security では、様々な繰り返しを追跡記録できるので、様々なバージョンのドキュメント情報を簡単に表示できます。

この機能が有効になっている場合、ドキュメントページからドキュメントの関連する繰り返しを表示できます。

1. ドキュメントのドキュメント詳細ページを表示します（[ドキュメントに関する情報の表示](controlling-access-policy-protected-documents.md#view-information-about-a-document)を参照）。
1. 「関連する繰り返しを表示」をクリックします。このオプションを使用できるのは、有効になっている場合だけです。関連する繰り返しのリストが表示されます。繰り返しごとに、次の情報が表示されます。

   * **繰り返し：**&#x200B;ファイル名。元のファイル名とは異なる場合があり、末尾にバージョン番号が付加されています。
   * **発行者：**&#x200B;元のドキュメントの発行者。
   * **作成者：**&#x200B;繰り返しを保存したユーザー。
   * **作成日：**&#x200B;繰り返しが保存された日付と時刻。
   * **ポリシー：**&#x200B;繰り返しを保護するポリシー。繰り返しによっては異なるポリシーで保護される場合があります。

1. 繰り返しのドキュメント詳細ページを表示するには、繰り返しのファイル名をクリックします。

## ドキュメントへのアクセス権限の失効および復元  {#revoking-and-reinstating-access-to-documents}

ポリシーで保護されたドキュメントへのアクセス権限を失効および復元できます。

**ユーザー：自分** の個人用ポリシーまたはポリシーを適用したドキュメントに対して失効機能が有効になっている共有ポリシーで保護したユーザーのアクセス権限を失効または復元できます。ドキュメントのアクセス権限を失効させることができない場合またはポリシーを切り替えることができない場合は、管理者に問い合わせてください。

**管理者：個人用ポリシーや共有ポリシーで保護され** たドキュメントなど、ポリシーで保護された任意の管理者へのアクセス権限を失効または復元できます。共有ポリシーで保護されたドキュメントのアクセス権限を失効させたのが管理者の場合、そのドキュメントのアクセス権限を復元できるのは管理者だけです。

**ポリシーセットコーディネーター：自分** のポリシーセットのポリシーで保護されたドキュメントのアクセス権限を失効または復元できます。

ドキュメントのアクセス権限を失効または復元すると、その変更は、次のタイミングで反映されます。

* ドキュメントがオンラインで閉じている場合は、ポリシーで保護された任意のドキュメントを受信者が次回オンラインで開いたとき、Document Security との同期が行われて変更が反映されます。
* ドキュメントがオンラインで開いている場合は、受信者がドキュメントを閉じると変更が反映されます。
* ドキュメントがオフラインの場合は（ラップトップコンピューターなど、インターネットに接続していない状態で使用している場合）、次に受信者が Document Security と同期するときに、変更が反映されます。

**ポリシーで保護されたドキュメントへのアクセス権限の失効**

1. Document Security ページで、「ドキュメント」をクリックします。
1. 目的のドキュメントの横のチェックボックスを選択し、「失効」をクリックします。同時に複数のドキュメントへのアクセス権限を失効させることができます。
1. 失効後にドキュメントを開こうとするユーザーに対して表示するメッセージを選択します。

   * **一般メッセージ：**&#x200B;作成者がドキュメントへのアクセス権限を失効させたことを示します。
   * **終了したドキュメント：**&#x200B;作成者がドキュメントを終了したことを示します。
   * **改訂済みのドキュメント：**&#x200B;作成者がドキュメントを改訂したことを示します。

1. （オプション）新バージョンのドキュメントが有効な場合は、URL を入力し、「テスト」をクリックして URL を確認します。
1. 「OK」をクリックし、再び「OK」をクリックして、ドキュメントページに戻ります。

**ドキュメントのアクセス権限の復元**

1. Document Security ページで、「ドキュメント」をクリックします。
1. ドキュメントのリストで、目的のドキュメントをクリックします。
1. 「失効取り消し」をクリックし、「OK」をクリックします。

## ドキュメントに適用されるポリシーの切り替え  {#switch-a-policy-that-is-applied-to-a-document}

ユーザー、ポリシーセットコーディネーターおよび管理者は、ポリシーで保護されたドキュメントに適用されるポリシーを切り替えることができます（ドキュメントには一度に 1 つのポリシーのみ適用できます）。ユーザーは、ポリシーが自分で作成したものである場合、またはポリシーの切り替えが有効化されている共有ポリシーの場合に、ポリシーで保護されたドキュメントに適用されるポリシーを切り替えることができます。それ以外の場合は、管理者またはポリシーセットコーディネーターがポリシーを切り替える必要があります。管理者は、ユーザーのポリシーで保護されたドキュメントのポリシーを切り替えることができます。ポリシーセットコーディネーターは、自分のポリシーセットのポリシーを切り替えることができます。

ポリシーを切り替えると、新しいポリシーは以下のように適用されます。

* ドキュメントがオンライン状態にあり、閉じている場合は、ポリシーで保護された任意のドキュメントを受信者が次回オンラインで開いたとき、Document Security との同期が行われて変更が反映されます。
* ドキュメントがオンラインで開いている場合は、ユーザーがドキュメントを閉じると変更が反映されます。
* ドキュメントがオフラインの場合は（ラップトップコンピューターなど、インターネットに接続していない状態で使用している場合）、ポリシーで保護された任意のドキュメントをユーザーが次回オンラインで開いたとき、Document Security との同期が行われて変更が反映されます。

>[!NOTE]
>
>現在匿名アクセスが許可されていない、ポリシーで保護されたドキュメントへの匿名アクセスを許可するには、クライアントアプリケーション内の既存ポリシーを削除してから、匿名アクセスを許可するポリシーを適用します。ポリシーを切り替えても、ユーザーはドキュメントにアクセスするためにログインする必要があります。

1. Document Security ページで、「ドキュメント」をクリックします。
1. ドキュメントのリストで、目的のドキュメントをクリックします。
1. 「ポリシーの切り替え」をクリックします。最大 100 個のポリシーが含まれるリストが表示されます。
1. 目的のポリシーが表示されない場合は、「検索」リストで「ポリシー名」または「ポリシー ID」を選択し、名前または ID を入力して、「検索」をクリックします。
1. リストから新しいポリシーをクリックします。
1. 「ポリシーの切り替え」をクリックし、「OK」をクリックして、ドキュメントページに戻ります。

## ドキュメントの検索  {#search-for-a-document}

ドキュメントページでは、日付範囲の条件と、リストに示されている検索条件を組み合わせて、ドキュメントを検索できます。これらの条件には、ドキュメント名、ポリシー名またはすべてのドキュメントが含まれます。

管理者だけが使用できる追加の検索オプションを次に示します。

**ドキュメントID：ポリシーが適用されるときにドキュメントセキュリティがドキュメントに割り当てる一意のID番号。** 

**ドキュメント名：ドキュメントの** 名前。

**発行者名：ドキュメントにポリシーを適用したユーザーの** 名前。すべてのドメインまたは指定したドメインからユーザーを選択できます。

**Policy ID:** IDドキュメントに関連付けられているポリシーの番号。

**ポリシー名：ドキュメントに適用されるポリシーの** 名前。

**すべてのドキュメント:** 管理者やユーザーが保護するすべてのドキュメント。「すべてのドキュメント」オプションを使用して検索すると、非常に多くのドキュメントが示されたリストが返される場合があります

1. Document Security ページで、「ドキュメント」をクリックします。
1. 「検索」リストで、必要な検索条件を選択します。

   条件には、ドキュメント ID、ドキュメント名、発行者名、ポリシー ID、ポリシー名またはすべてのドキュメントを指定できます。

   発行者名を指定する場合は、アドレス帳アイコンをクリックし、ユーザーを検索するドメインを指定し、「OK」をクリックしてドキュメント検索ページに戻ります。

1. （オプション）「日付」リストから、日付範囲のオプションを選択します。「カスタム日付」を選択し、表示されるボックスに yyyy/mm/dd の形式で日付を入力します。または、次のように日付選択を使用して日付範囲を指定します。

   * カレンダーをクリックすると、日付選択が開きます。
   * 矢印を使用して、該当する年と月を探します。
   * 該当する日をクリックします。
   * 「OK」をクリックすると、日付選択が閉じます。

1. 「検索」をクリックします。

## ドキュメントリストのソート  {#sort-the-document-list}

列見出しでドキュメントのリストをソートできます。列見出しの横の三角形のアイコンは、現在ソートに使用されている列を表します。上向きの三角形は昇順を、下向きの三角形は降順を示しています。

1. Document Security ページで、「ドキュメント」をクリックします。
1. 該当する列見出しをクリックします。
1. ソート順を変更するには、列を再びクリックします。

## ポリシーで保護されたドキュメントへの表紙の追加  {#add-cover-page-to-policy-protected-documents}

ほとんどの Adobe 以外の PDF ビューアの場合、Document Security で保護されたドキュメントを開くと、最初のページが空白ページとして表示されるか、アプリケーションがドキュメントを開かずに中止されます。

ページ 0（ラッパードキュメント）サポートを使用してアドビ以外の PDF ビューアで保護されたドキュメントを開き、ドキュメントの表紙を表示できます。

>[!NOTE]
>
>Adobe Reader/Acrobat または Mobile Reader で（ページ 0 を含む）このようなドキュメントを表示する場合、デフォルトで保護されたドキュメントが開かれます。

**ポリシーで保護されたドキュメントに表紙を追加するには**

Workbench で次のプロセスを使用します。

**表紙付きProtectドキュメント：指定したポリシーでPDFドキュメントを** 保護し、表紙をドキュメントに追加します

**保護ドキュメントの抽出：ポリシーで保護されたPDFドキュメントを表紙付きのPDFドキュメントから** 抽出します

次の Document Security API を使用します。

**protectDocumentWithCoverPage：指定したポリシーで特定のPDFを保護し、表紙と保護されたドキュメントのドキュメントを添付ファイル** extractProtectedDocument：表紙付きのドキュメントの添付ファイルである保護されたドキュメント
`//Create a ServiceClientFactory instance ServiceClientFactory factory = ServiceClientFactory.createInstance(connectionProps); //Create a RightsManagementClient object RightsManagementClient rightsClient = new RightsManagementClient(factory); //Reference a PDF document to which a policy is applied FileInputStream fileInputStream = new FileInputStream("C:\\testFile.pdf"); Document inPDF = new Document(fileInputStream); //Reference a Cover Page document FileInputStream coverPageInputStream = new FileInputStream("C:\\CoverPage.pdf"); Document inCoverDoc = new Document(coverPageInputStream); //Create a Document Manager object DocumentManager documentManager = rightsClient.getDocumentManager(); //Apply a policy to the PDF document RMSecureDocumentResult rmSecureDocument = documentManager.protectDocumentWithCoverPage( inPDF, "ProtectedPDF.pdf", "PolicySetName", "PolicyName", null, null, inCoverDoc, true); //Retrieve the policy-protected PDF document Document protectPDF = rmSecureDocument.getProtectedDoc(); //Save the policy-protected PDF document File myFile = new File("C:\\PolicyProtectedDoc.pdf"); protectPDF.copyToFile(myFile);` **** を抽出します。表紙付きのドキュメントは protectDocumentWithCoverPage メソッドを使用して作成されます
`//Create a ServiceClientFactory instance ServiceClientFactory factory = ServiceClientFactory.createInstance(connectionProps); //Create a RightsManagementClient object RightsManagementClient rightsClient = new RightsManagementClient(factory); //Reference a protected PDF document with a Cover Page FileInputStream fileInputStream = new FileInputStream("C:\\policyProtectedDocWithCoverPage.pdf"); Document inPDF = new Document(fileInputStream); //Create a Document Manager object DocumentManager documentManager = rightsClient.getDocumentManager(); //Apply a policy to the PDF document Document extractedDoc = documentManager.extractProtectedDocument(inPDF); //Save the policy-protected PDF document File myFile = new File("C:\\PolicyProtectedDoc.pdf"); extractedDoc.copyToFile(myFile);`