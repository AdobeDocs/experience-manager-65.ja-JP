---
title: ポリシーで保護されたドキュメントへのアクセス制御
seo-title: Controlling access to policy-protected documents
description: ポリシーで保護されたドキュメントへのアクセスを表示、管理、制御する方法を確認します。
seo-description: See how you can view, manage and control the access to your policy-protected documents.
uuid: 2d9f95e9-e4ee-47e2-988e-a191d1d1d264
contentOwner: admin
content-type: reference
geptopics: SG_AEMFORMS/categories/working_with_document_security
products: SG_EXPERIENCEMANAGER/6.5/FORMS
discoiquuid: f34058c3-384a-4b73-a386-5bc9125acbf8
feature: Document Security
exl-id: 0eb6e769-97c1-41ee-8d12-91bece984947
source-git-commit: 10b370fd8f855f71c6d7d791c272137bb5e04d97
workflow-type: tm+mt
source-wordcount: '2167'
ht-degree: 22%

---

# ポリシーで保護されたドキュメントへのアクセス制御 {#controlling-access-to-policy-protected-documents}

ポリシーで保護されたドキュメントを、どれだけ広く配布しても、受信者がそのドキュメントを使用する方法を制御できます。

ドキュメントページでは、次のタスクを実行できます。

* ポリシーで保護されたドキュメントの詳細を検索して表示します。 ドキュメント名、発行者名、ポリシー名、ポリシーが適用された日付に関する情報を確認できます。 ドキュメントを保護したポリシーが削除された場合は、ポリシー名の下に削除されたポリシー ID も表示されます。 ユーザーは、ポリシーで保護された独自のドキュメントを表示および管理できます。 管理者は、ポリシーで保護されたすべてのドキュメントを表示および管理できます。
* ドキュメントに適用されるポリシーの詳細を変更します。 ユーザーは独自のポリシーを編集でき、管理者は共有ポリシーと個人用ポリシーを編集でき、ポリシーセットコーディネーターは自分が権限を持つポリシーセット内の共有ポリシーを編集できます。 ドキュメントに関連付けられているポリシーには、ドキュメントの詳細ページから直接アクセスできます。
* ポリシーで保護されたドキュメントへのアクセス権を失効および復元します。 管理者は、任意のドキュメントへのアクセスを失効および回復できます。 ポリシーセットコーディネーター（ドキュメントを管理する権限を持つユーザー）は、ポリシーセットの共有ポリシーを使用する、ポリシーで保護されたドキュメントへのアクセスを失効および復元できます。 ドキュメントを保護するポリシーを作成した場合、またはこの機能を許可する共有ポリシーがポリシーである場合は、ポリシーで保護されたドキュメントへのアクセスを取り消すことができます。
* ドキュメントに適用するポリシーを切り替えます。 ドキュメントにポリシーを適用するユーザーは、ポリシーを作成した場合、またはこの機能を有効にする共有ポリシーの場合に、ポリシーを切り替えることができます。 ポリシーセットコーディネーターは、自分のポリシーセットからポリシーを切り替えることができます。 管理者は、任意のドキュメントに適用されるポリシーを切り替えることができます。

ドキュメントがポリシーで保護され、アクセス権限を取り消したり、適用されたポリシーを切り替えたりすると、変更は次のように反映されます。

* ドキュメントがオンラインの場合は、ユーザーがドキュメントを開いていない限り、変更が直ちに適用されます。 この場合、ユーザーはドキュメントを閉じて、変更を反映させる必要があります。
* 受信者がドキュメントをオフラインで使用している場合（ノート PC など）、受信者が次回、ポリシーで保護されたドキュメントを開くことで Document Security と同期したときに、変更が反映されます。

## ドキュメントに関する情報の表示 {#view-information-about-a-document}

ドキュメントページに表示される各ドキュメントについて、ドキュメント名、発行者名、ポリシー名、ドキュメントが保護された日付を確認できます。 ドキュメントを保護したポリシーが削除された場合は、ポリシー ID が「ポリシー名」の下に表示されます。

特定のドキュメントに関する詳細（以下で説明）をドキュメントの詳細ページに表示することもできます。

>[!NOTE]
>
>ドキュメントの詳細ページの「ポリシー名」リンクを使用して、電子メールメッセージに添付されたドキュメントの受信者に対してMicrosoft Outlook で自動生成されるポリシーにアクセスします。 これらのポリシーは、ポリシーページには表示されません。

**ドキュメント名：**&#x200B;選択したドキュメントの名前

**ドキュメント ID：**&#x200B;ドキュメントにポリシーが適用されるときに Document Security がよって割り当てる一意の識別子。Document Security では、この番号を使用してドキュメントが追跡されます。

**ドキュメントのステータス：**&#x200B;ドキュメントのステータス（アクティブ、失効など）

**発行者：**&#x200B;ポリシーをドキュメントに添付したユーザーの名前

**ポリシー名：**&#x200B;ドキュメントを保護するために使用されるポリシーの名前名前をクリックして、ポリシーを開くことができます。 このリンクを使用して、Outlook の電子メールメッセージに添付されたドキュメントの受信者に対してAcrobatが生成するポリシーにアクセスします。 これらのポリシーは、ポリシーページには表示されません。

**ポリシータイプ：**&#x200B;ドキュメントに適用されたポリシーのタイプ

**発行日：**&#x200B;ポリシーがドキュメントに適用された日付

**関連する繰り返し：**&#x200B;ドキュメントに関連する繰り返しがある場合、この項目もリストに表示されます。リンクをクリックして、ドキュメントの関連する繰り返しのリストを表示します。

ユーザーは、保護されたドキュメントに関する情報を表示できます。 管理者は、ポリシーで保護されたドキュメントに関する情報を表示できます。 ポリシーセットコーディネーターは、ポリシーで保護されたドキュメントに関する情報を、自分のポリシーセットから表示できます。

1. Document Security ページで、「ドキュメント」をクリックします。
1. ドキュメントのリストで、適切なドキュメントをクリックします。 ドキュメントの詳細ページが開き、ドキュメントに関する詳細情報が表示されます。 このページには、ドキュメントアクセスの取り消し、ポリシーの切り替え、およびこのドキュメントに関連するイベントの表示のオプションも用意されています。

## ドキュメントの関連する繰り返しの表示 {#view-related-iterations-for-a-document}

関連する繰り返しの追跡が有効な場合、様々なユーザーが保存したドキュメントのバージョンを追跡できます。 この機能は、PTC Pro/ENGINEER Wildfire などの特定のアプリケーションでのみサポートされます。

この機能は、複数のユーザーが共同作業を行い、同じドキュメントの異なるバージョンを保存する場合に役立ちます。 Document Security では、様々な繰り返しを追跡できるので、様々なバージョンのドキュメント情報を簡単に表示できます。

この機能を有効にした場合、ドキュメントページからドキュメントの関連する繰り返しを表示できます。

1. ドキュメントのドキュメントの詳細ページを表示します。 ( 詳しくは、 [ドキュメントに関する情報の表示](controlling-access-policy-protected-documents.md#view-information-about-a-document).)
1. 「関連する繰り返しを表示」(View Related Iterations) をクリックします。 このオプションは、この機能が有効な場合にのみ使用できます。 関連する繰り返しのリストが表示されます。 繰り返しごとに、次の情報が表示されます。

   * **繰り返し：**&#x200B;ファイル名。元のファイル名とは異なる場合があり、末尾にバージョン番号が付加されています。
   * **公開者：**&#x200B;元のドキュメントの公開者。
   * **作成者：**&#x200B;繰り返しを保存したユーザー。
   * **作成日：**&#x200B;繰り返しが保存された日付と時刻。
   * **ポリシー：**&#x200B;繰り返しを保護するポリシー。繰り返しごとに異なるポリシーで保護される場合があります。

1. その反復のドキュメント詳細ページを表示するには、反復のファイル名をクリックします。

## ドキュメントへのアクセス権の取り消しと回復 {#revoking-and-reinstating-access-to-documents}

ポリシーで保護されたドキュメントへのアクセス権を失効および復元できます。

**ユーザー：**&#x200B;ドキュメントがユーザーの個人用ポリシーで保護されている場合、またはポリシーを適用するユーザーに対するポリシーの失効機能が有効になっている共有ポリシーで保護されている場合は、そのドキュメントへのアクセス権限を失効および復元できます。ドキュメントのアクセス権限を失効させることができない場合またはポリシーを切り替えることができない場合は、管理者に問い合わせてください。

**管理者：**&#x200B;個人用または共有ポリシーで保護されたドキュメントなど、ポリシーで保護されたすべてのドキュメントへのアクセス権限を失効および復元できます。共有ポリシーで保護されたドキュメントのアクセス権限を失効させたのが管理者の場合、そのドキュメントのアクセス権限を復元できるのは管理者だけです。

**ポリシーセットコーディネーター：**&#x200B;ポリシーセットのポリシーで保護されたドキュメントのアクセス権限を失効および復元できます。

ドキュメントのアクセス権限を失効または回復すると、変更は次の場合に有効になります。

* ドキュメントがオンラインで閉じられている場合、受信者が次にポリシーで保護されたドキュメントを開くことで Document Security と同期すると、変更が反映されます。
* ドキュメントがオンラインで開いている場合は、受信者がドキュメントを閉じると変更が反映されます。
* ドキュメントがオフラインの場合（ノート PC など、インターネットに接続していない状態で使用されている場合）、受信者が次回 Document Security と同期したときに、変更が反映されます。

**ポリシーで保護されたドキュメントへのアクセスの取り消し**

1. Document Security ページで、「ドキュメント」をクリックします。
1. 適切なドキュメントの横にあるチェックボックスを選択し、「失効」をクリックします。 一度に複数のドキュメントへのアクセスを取り消すことができます。
1. 失効後にドキュメントを開こうとしたユーザーに表示するメッセージを選択します。

   * **一般メッセージ：**&#x200B;作成者がドキュメントへのアクセス権限を失効させたことを示します。
   * **終了したドキュメント：**&#x200B;作成者がドキュメントを終了したことを示します。
   * **ドキュメントの改訂**：作成者がドキュメントを修正したことを示します

1. （オプション）新しいバージョンのドキュメントが使用可能な場合は、URL を入力し、「テスト」をクリックして URL を確認します。
1. [OK] をクリックし、[OK] を再度クリックして [ ドキュメント ] ページに戻ります。

**ドキュメントのアクセス権限の回復**

1. Document Security ページで、「ドキュメント」をクリックします。
1. ドキュメントのリストで、適切なドキュメントをクリックします。
1. 「失効取り消し」をクリックし、「OK」をクリックします。

## ドキュメントに適用されるポリシーの切り替え {#switch-a-policy-that-is-applied-to-a-document}

ユーザー、ポリシーセットコーディネーター、管理者は、ポリシーで保護されたドキュメントに適用されるポリシーを切り替えることができます（ドキュメントには一度に 1 つのポリシーのみを適用できます）。 ポリシーを作成した場合、またはこの機能を有効にした共有ポリシーの場合は、ポリシーで保護された独自のドキュメントに適用されるポリシーを切り替えることができます。 そうでない場合は、管理者またはポリシーセットコーディネーターがポリシーを切り替える必要があります。 管理者は、ポリシーで保護されたすべてのユーザーのドキュメントのポリシーを切り替えることができます。 ポリシーセットコーディネーターは、自分のポリシーセットからポリシーを切り替えることができます。

ポリシーを切り替えると、新しいポリシーは次のように適用されます。

* ドキュメントがオンラインで閉じられている場合、ポリシーで保護されたドキュメントを受信者が次回オンラインで開いたときに、Document Security との同期が行われます。
* ドキュメントがオンラインで開いている場合、ユーザーがドキュメントを閉じると、変更が有効になります。
* ドキュメントがオフラインの場合（ノート PC など、インターネットやネットワークに接続していない状態で使用されている場合）は、ユーザーが次回、ポリシーで保護されたドキュメントをオンラインで開くと、Document Security との同期時に変更が適用されます。

>[!NOTE]
>
>ポリシーで保護されたドキュメントに対し、現在このアクセス権を持っていない匿名アクセスを許可するには、クライアントアプリケーションの既存のポリシーを削除し、匿名アクセスを許可するポリシーを適用します。 ポリシーを切り替えても、ユーザーはドキュメントにアクセスするためにログインする必要があります。

1. Document Security ページで、「ドキュメント」をクリックします。
1. ドキュメントのリストで、適切なドキュメントをクリックします。
1. [ ポリシーの切り替え ] をクリックします。 最大 100 個のポリシーのリストが表示されます。
1. 目的のポリシーが表示されない場合は、[ 検索 ] ボックスの一覧から [ ポリシー名 ] または [ ポリシー ID] を選択し、名前または ID を入力して、[ 検索 ] をクリックします。
1. リストで新しいポリシーをクリックします。
1. [ ポリシーの切り替え ] をクリックし、[OK] をクリックして [ ドキュメント ] ページに戻ります。

## ドキュメントの検索 {#search-for-a-document}

ドキュメントページでは、日付範囲の条件とリストに表示される検索条件を組み合わせてドキュメントを検索できます。 これらの条件には、ドキュメント名、ポリシー名、またはすべてのドキュメントが含まれます。

その他の検索オプションの一部は、管理者のみが使用できます。

**ドキュメント ID：**&#x200B;ポリシーが適用されるときに Document Security によってドキュメントに割り当てられる一意の ID 番号。

**ドキュメント名：**&#x200B;ドキュメントの名前

**発行者名：**&#x200B;ポリシーをドキュメントに添付したユーザーの名前すべてのドメインまたは指定したドメインからユーザーを選択できます。

**ポリシー ID：**&#x200B;ドキュメントに添付されているポリシーの ID 番号

**ポリシー名：**&#x200B;ドキュメントに添付されているポリシーの名前

**すべてのドキュメント：**&#x200B;管理者およびユーザーによって保護されるすべてのドキュメント「すべてのドキュメント」オプションを使用して検索すると、長いドキュメントのリストが返される場合があります。

1. Document Security ページで、「ドキュメント」をクリックします。
1. 「検索」リストで、必要な検索条件を選択します。

   条件は、ドキュメント ID、ドキュメント名、発行者名、ポリシー ID、ポリシー名、またはすべてのドキュメントとして指定できます。

   発行者名を指定する場合は、[ アドレス帳 ] アイコンをクリックし、ユーザーを検索するドメインを指定し、[OK] をクリックして [ ドキュメント ] 検索ページに戻ります。

1. （オプション）「日付」リストで、日付範囲オプションを選択します。 「カスタム日付」を選択した場合は、表示されるボックスに日付を yyyy/mm/dd の形式で入力するか、日付選択を使用して日付範囲を指定します。

   * カレンダーをクリックして、日付選択を開きます。
   * 矢印を使用して、年と月を検索します。
   * カレンダー上の月の日をクリックします。
   * 「 OK 」をクリックして、日付選択を閉じます。

1. 「検索」をクリックします。

## ドキュメントリストの並べ替え {#sort-the-document-list}

列見出しでドキュメントのリストを並べ替えることができます。 列見出しの横にある三角形のアイコンは、現在どの列が並べ替えに使用されているかを示します。 上向きの三角形は昇順を示し、下向きの三角形は降順を示します。

1. Document Security ページで、「ドキュメント」をクリックします。
1. 該当する列見出しをクリックします。
1. 並べ替え順を変更するには、列を再度クリックします。

## ポリシーで保護されたドキュメントに表紙を追加する {#add-cover-page-to-policy-protected-documents}

Adobe PDF以外のビューアがほとんどの場合、Document Security で保護されたドキュメントを開くと、最初のページが空白のページとして表示されるか、アプリケーションがドキュメントを開かずに中止します。

Page 0(Wrapper Document) のサポートを使用すると、Adobe PDF以外の閲覧者が保護されたドキュメントを開いてドキュメントの表紙を表示できるようになります。

>[!NOTE]
>
>Adobe Reader/AcrobatまたはモバイルReaderで（ページ 0 を含む）このようなドキュメントを表示すると、保護されたドキュメントがデフォルトで開かれます。

**ポリシーで保護されたドキュメントに表紙を追加するには**

Workbench で次のプロセスを使用します。

**表紙付きの
ドキュメントの保護：**&#x200B;指定されたポリシーでPDF ドキュメントを保護し、ドキュメントに表紙を追加

**保護されたドキュメントを抽出：**&#x200B;ポリシーで保護された PDF ドキュメントを表紙付きの PDF ドキュメントから抽出

次の Document Security API を使用します。

**protectDocumentWithCoverPage：**特定の PDF を指定したポリシーで保護し、表紙付きのドキュメントと保護されたドキュメントを添付ファイルとして返します
`//Create a ServiceClientFactory instance ServiceClientFactory factory = ServiceClientFactory.createInstance(connectionProps); //Create a RightsManagementClient object RightsManagementClient rightsClient = new RightsManagementClient(factory); //Reference a PDF document to which a policy is applied FileInputStream fileInputStream = new FileInputStream("C:\\testFile.pdf"); Document inPDF = new Document(fileInputStream); //Reference a Cover Page document FileInputStream coverPageInputStream = new FileInputStream("C:\\CoverPage.pdf"); Document inCoverDoc = new Document(coverPageInputStream); //Create a Document Manager object DocumentManager documentManager = rightsClient.getDocumentManager(); //Apply a policy to the PDF document RMSecureDocumentResult rmSecureDocument = documentManager.protectDocumentWithCoverPage( inPDF, "ProtectedPDF.pdf", "PolicySetName", "PolicyName", null, null, inCoverDoc, true); //Retrieve the policy-protected PDF document Document protectPDF = rmSecureDocument.getProtectedDoc(); //Save the policy-protected PDF document File myFile = new File("C:\\PolicyProtectedDoc.pdf"); protectPDF.copyToFile(myFile);` **extractProtectedDocument：**表紙付きのドキュメント内の添付ファイルである保護されたドキュメントを抽出します。表紙付きのドキュメントは protectDocumentWithCoverPage メソッドを使用して作成されます
`//Create a ServiceClientFactory instance ServiceClientFactory factory = ServiceClientFactory.createInstance(connectionProps); //Create a RightsManagementClient object RightsManagementClient rightsClient = new RightsManagementClient(factory); //Reference a protected PDF document with a Cover Page FileInputStream fileInputStream = new FileInputStream("C:\\policyProtectedDocWithCoverPage.pdf"); Document inPDF = new Document(fileInputStream); //Create a Document Manager object DocumentManager documentManager = rightsClient.getDocumentManager(); //Apply a policy to the PDF document Document extractedDoc = documentManager.extractProtectedDocument(inPDF); //Save the policy-protected PDF document File myFile = new File("C:\\PolicyProtectedDoc.pdf"); extractedDoc.copyToFile(myFile);`
