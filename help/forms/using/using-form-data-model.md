---
title: フォームデータモデルの使用
description: フォームデータモデルを使用して、アダプティブフォームとインタラクティブ通信を作成し、操作する方法について説明します。
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: integration
docset: aem65
feature: Form Data Model
exl-id: 9a73a643-7ad4-49aa-a971-08d52679158d
source-git-commit: 8b4cb4065ec14e813b49fb0d577c372790c9b21a
workflow-type: tm+mt
source-wordcount: '1268'
ht-degree: 41%

---

# フォームデータモデルの使用{#use-form-data-model}

| バージョン | 記事リンク |
| -------- | ---------------------------- |
| AEM as a Cloud Service | [ここをクリックしてください](https://experienceleague.adobe.com/docs/experience-manager-cloud-service/content/forms/integrate/use-form-data-model/using-form-data-model.html) |
| AEM 6.5 | この記事 |


![hero-image](do-not-localize/data-integration.png)

AEM Formsのデータ統合機能を使用すると、異なるバックエンドデータソースを使用して、様々なアダプティブフォームやインタラクティブ通信ワークフローでスキーマとして使用できるフォームデータモデルを作成できます。 データソースの設定と、データソースで使用可能なデータモデルオブジェクトとサービスに基づくフォームデータモデルの作成が必要です。 詳しくは、以下のトピックを参照してください。

* [AEM Forms のデータ統合機能](../../forms/using/data-integration.md)
* [データソースの設定](../../forms/using/configure-data-sources.md)
* [フォームデータモデルの作成](../../forms/using/create-form-data-models.md)
* [フォームデータモデルの操作](../../forms/using/work-with-form-data-model.md)

JSON スキーマの拡張機能であるフォームデータモデルを使用して、以下の処理を行うことができます。

* [アダプティブフォームとアダプティブフォームフラグメントを作成する](#create-af)
* [インタラクティブ通信と、構築ブロック（テキストフラグメント、リストフラグメント、条件フラグメントなど）を作成する](#create-ic)
* [サンプルデータを使用してインタラクティブ通信のプレビューを表示する](#preview-ic)
* [アダプティブフォームとインタラクティブ通信に事前にデータを取り込む](#prefill)
* [送信されたアダプティブフォームのデータをデータソースに書き込む](#write-af)
* [アダプティブフォームのルールを使用してサービスを呼び出す](#invoke-services)

## アダプティブフォームとアダプティブフォームフラグメントを作成する {#create-af}

次の項目を作成できます。 [アダプティブフォーム](../../forms/using/creating-adaptive-form.md) および [アダプティブフォームフラグメント](../../forms/using/adaptive-form-fragments.md) フォームデータモデルに基づく。 アダプティブフォームまたはアダプティブフォームフラグメントを作成する際にフォームデータモデルを使用するには、以下の手順を実行します。

1. プロパティを追加画面の「フォームモデル」タブで、 **[!UICONTROL 次から選択]** ドロップダウンリストから「**[!UICONTROL フォームデータモデル]**」を選択します。

   ![create-af-1-1](assets/create-af-1-1.png)

1. 選択して展開 **[!UICONTROL フォームデータモデルを選択]**. 使用可能なすべてのフォームデータモデルが表示されます。

   データモデルからを選択します。

   ![create-af-2-1](assets/create-af-2-1.png)

1. (**アダプティブフォームフラグメントのみ**) フォームデータモデル内の 1 つのデータモデルオブジェクトのみに基づいて、アダプティブフォームフラグメントを作成することができます。 **[!UICONTROL フォームデータモデル定義]**&#x200B;ドロップダウンを展開します。指定したフォームデータモデル内のすべてのデータモデルオブジェクトがリスト表示されます。リストから、データモデルオブジェクトを選択します。

   ![create-af-3](assets/create-af-3.png)

フォームデータモデルに基づいてアダプティブフォームまたはアダプティブフォームフラグメントを作成すると、アダプティブフォームエディターのコンテンツブラウザーの「**[!UICONTROL データモデルオブジェクト]**」タブにフォームデータモデルオブジェクトが表示されます。

>[!NOTE]
>
>アダプティブフォームフラグメントの場合は、オーサリング時に選択したデータモデルオブジェクトと、そのオブジェクトに関連付けられているデータモデルオブジェクトだけが、「データモデルオブジェクト」タブに表示されます。

![data-model-objects-tab](assets/data-model-objects-tab.png)

データモデルオブジェクトをアダプティブフォームまたはアダプティブフォームフラグメントにドラッグアンドドロップすると、フォームフィールドを追加することができます。追加されたフォームフィールドには、メタデータのプロパティが保持され、データモデルオブジェクトのプロパティとの連結が保持されます。 連結により、フォームの送信時に対応するデータソースのフィールド値が更新され、フォームのレンダリング時に事前入力されます。

## インタラクティブ通信の作成 {#create-ic}

フォームデータモデルに基づいてインタラクティブ通信を作成し、設定済みのデータソースのデータをインタラクティブ通信に事前入力することができます。 また、テキスト、リスト、条件のドキュメントフラグメントなどのインタラクティブ通信の構築ブロックは、フォームデータモデルに基づいて作成できます。

インタラクティブ通信またはドキュメントフラグメントを作成する際に、フォームデータモデルを選択できます。 次の図は、[ インタラクティブ通信を作成 ] ダイアログの [ 全般 ] タブを示しています。

![create-ic](assets/create-ic.png)

インタラクティブ通信を作成ダイアログの「一般」タブ

詳しくは、次を参照してください。

[インタラクティブ通信の作成](../../forms/using/create-interactive-communication.md)

[インタラクティブ通信内のテキスト](/help/forms/using/texts-interactive-communications.md)

[インタラクティブ通信内の条件](/help/forms/using/conditions-interactive-communications.md)

[リストフラグメント](/help/forms/using/lists.md)

## サンプルデータを使用したプレビュー {#preview-ic}

フォームデータモデルエディターを使用すると、フォームデータモデル内のデータモデルオブジェクトのサンプルデータを生成し、編集することができます。 このデータを使用して、インタラクティブ通信とアダプティブフォームをプレビューし、テストすることができます。 プレビュー前にサンプルデータを生成します。詳しくは、 [フォームデータモデルの使用](../../forms/using/work-with-form-data-model.md#sample).

サンプルのフォームデータモデルデータを使用してインタラクティブ通信をプレビューするには、次の手順を実行します。

1. AEM オーサーインスタンスで、**[!UICONTROL フォーム／フォームとドキュメント]**&#x200B;に移動します。
1. インタラクティブ通信を選択し、 **[!UICONTROL プレビュー]** ツールバーで、 **[!UICONTROL Web チャネル]**, **[!UICONTROL 印刷チャネル]**&#x200B;または **[!UICONTROL 両方のチャネル]** ：インタラクティブ通信をプレビューします。
1. プレビューで [*チャネル*] ダイアログで、次の点を確認します。 **[!UICONTROL フォームデータモデルのテストデータ]** を選択し、「 **[!UICONTROL プレビュー]**.

サンプルデータが取り込まれた状態のインタラクティブ通信が表示されます。

![web-preview](assets/web-preview.png)

同様に、サンプルデータを含むアダプティブフォームをプレビューするには、アダプティブフォームをオーサリングモードで開き、「 」を選択します。 **[!UICONTROL プレビュー]**.

## フォームデータモデルサービスを使用した事前入力 {#prefill}

AEM Formsには、すぐに使用できるフォームデータモデル事前入力サービスが用意されています。このサービスを使用して、フォームデータモデルに基づいたアダプティブフォームとインタラクティブ通信を有効にすることができます。 事前入力サービスは、アダプティブフォームおよびインタラクティブ通信内のデータモデルオブジェクトに対してデータソースに対してクエリを実行し、その結果、フォームまたは通信のレンダリング中にデータを事前入力します。

アダプティブフォームのフォームデータモデル事前入力サービスを有効にするには、アダプティブフォームコンテナのプロパティを開き、「 **[!UICONTROL フォームデータモデルの事前入力サービス]** から **[!UICONTROL 事前入力サービス]** 「基本」アコーディオンのドロップダウン。 次に、各プロパティを保存します。

![prefill-service](assets/prefill-service.png)

インタラクティブ通信でフォームデータモデル事前入力サービスを設定するには、インタラクティブ通信の作成時に「事前入力サービス」ドロップダウンで「フォームデータモデル事前入力サービス」を選択します。後でプロパティを編集することもできます。

![edit-ic-props](assets/edit-ic-props.png)

インタラクティブ通信のプロパティを編集ダイアログ

## 送信後のアダプティブフォームデータをデータソースに書き込む {#write-af}

ユーザーがフォームデータモデルに基づいてフォームを送信するとき、データモデルオブジェクトの送信データがそのデータソースに書き込まれるようにフォームを設定することができます。この使用例を実現するために、AEM Formsでは、 [フォームデータモデルの送信アクション](../../forms/using/configuring-submit-actions.md)：フォームデータモデルに基づくアダプティブフォームでのみ、そのまま使用できます。 これにより、データモデルオブジェクトに送信されたデータが、そのデータソースに書き込まれます。

フォームデータモデル送信アクションを設定するには、アダプティブフォームコンテナのプロパティを開き、送信アコーディオンの「送信アクション」ドロップダウンで「**[!UICONTROL フォームデータモデルを使用して送信]**」を選択します。次に、 **[!UICONTROL 送信するデータモデルオブジェクトの名前]** ドロップダウンで、目的のデータモデルオブジェクトを探して選択します。各プロパティを保存します。

フォームの送信時に、設定済みのデータモデルオブジェクトのデータが各データソースに書き込まれます。

![data-submission](assets/data-submission.png)

バイナリデータモデルオブジェクトのプロパティを使用して、フォームの添付ファイルをデータソースに送信することもできます。 添付ファイルを JDBC データソースに送信するには、次の手順を実行します。

1. バイナリプロパティを含むデータモデルオブジェクトをフォームデータモデルに追加します。
1. アダプティブフォームで、「**[!UICONTROL 添付ファイル]**」コンポーネントをコンポーネントブラウザーからアダプティブフォームにドラッグ＆ドロップします。
1. 「 」を選択して追加したコンポーネントを選択し、「 」を選択します。 ![settings_icon](assets/settings_icon.png) をクリックして、コンポーネントのプロパティブラウザーを開きます。
1. 「バインド参照」フィールドで、「 ![foldersearch_18](assets/foldersearch_18.png) フォームデータモデルに追加したバイナリプロパティに移動して選択します。 必要に応じて、他のプロパティを設定します。

   選択 ![check-button](assets/check-button.png) をクリックしてプロパティを保存します。 これで、添付フィールドがフォームデータモデルのバイナリプロパティにバインドされました。

1. アダプティブフォームコンテナプロパティの「送信」セクションで、 **[!UICONTROL フォームの添付ファイルを送信]**. バイナリプロパティフィールド内の添付ファイルが、フォーム送信時にデータソースに送信されます。

## ルールを使用してアダプティブフォーム内のサービスを呼び出す {#invoke-services}

フォームデータモデルに基づくアダプティブフォームの場合、[ルールを作成](../../forms/using/rule-editor.md)して、フォームデータモデル内で設定されているサービスを呼び出すことができます。The **[!UICONTROL サービスを起動]** ルール内の操作を実行すると、フォームデータモデル内の使用可能なすべてのサービスが一覧表示され、サービスの入力フィールドと出力フィールドを選択できます。 また、 **値を設定** ルールタイプ：フォームデータモデルサービスを呼び出し、サービスから返される出力にフィールドの値を設定します。

例えば以下のルールの場合、従業員 ID を入力として使用する Get サービスが呼び出され、このサービスから返された値が、フォーム内の対応する扶養家族 ID フィールド、姓フィールド、名フィールド、性別フィールドに設定されます。

![invoke-service](assets/invoke-service.png)

また、`guidelib.dataIntegrationUtils.executeOperation` API を使用して、ルールエディターのコードエディターで JavaScript を記述することもできます。API について詳しくは、「[フォームデータモデルサービスを呼び出すための API](/help/forms/using/invoke-form-data-model-services.md)」を参照してください。
