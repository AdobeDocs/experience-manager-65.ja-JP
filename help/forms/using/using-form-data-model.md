---
title: フォームデータモデルの使用
seo-title: Use form data model
description: ここでは、フォームデータモデルを使用してアダプティブフォームとインタラクティブ通信を作成し、それらを使用する方法について説明します。
seo-description: Learn how to use form data model to create and work with adaptive forms and interactive communications.
uuid: 9d8d8f43-9a50-4905-a6ef-a5ea3b9c11f7
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: integration
discoiquuid: 87f5f9f5-2d03-4565-830e-eacc3757e542
docset: aem65
feature: Form Data Model
exl-id: 9a73a643-7ad4-49aa-a971-08d52679158d
source-git-commit: b220adf6fa3e9faf94389b9a9416b7fca2f89d9d
workflow-type: ht
source-wordcount: '1252'
ht-degree: 100%

---

# フォームデータモデルの使用{#use-form-data-model}

![](do-not-localize/data-integeration.png)

AEM Forms のデータ統合機能により、各種のバックエンドデータソースを使用してフォームデータモデルを作成することができます。作成したデータフォームは、様々なアダプティブフォームとインタラクティブ通信のワークフローで、スキーマとして使用することができます。そのためには、データソースの設定を行い、そのデータソース内の有効なデータモデルオブジェクトとデータモデルサービスに基づいて、フォームデータモデルを作成する必要があります。詳しくは、以下のトピックを参照してください。

* [AEM Forms のデータ統合機能](../../forms/using/data-integration.md)
* [データソースの設定](../../forms/using/configure-data-sources.md)
* [フォームデータモデルの作成](../../forms/using/create-form-data-models.md)
* [フォームデータモデルの操作](../../forms/using/work-with-form-data-model.md)

JSON スキーマの拡張機能であるフォームデータモデルを使用して、以下の処理を行うことができます。

* [アダプティブフォームとアダプティブフォームフラグメントを作成する](#create-af)
* [インタラクティブ通信と、構築ブロック（テキストフラグメント、リストフラグメント、条件フラグメントなど）を作成する](#create-ic)
* [サンプルデータを使用してインタラクティブ通信のプレビューを表示する](#preview-ic)
* [アダプティブフォームとインタラクティブ通信に事前にデータを取り込む](#prefill)
* [送信されたアダプティブフォームのデータをデータソースに書き込む](#write-af)
* [アダプティブフォームのルールを使用してサービスを呼び出す](#invoke-services)

## アダプティブフォームとアダプティブフォームフラグメントを作成する {#create-af}

フォームデータモデルに基づいて、[アダプティブフォーム](../../forms/using/creating-adaptive-form.md)と[アダプティブフォームフラグメント](../../forms/using/adaptive-form-fragments.md)を作成することができます。フォームデータモデルを使用してアダプティブフォームまたはアダプティブフォームフラグメントを作成するには、以下の手順を実行します。

1. プロパティを追加画面の「フォームモデル」タブで、**[!UICONTROL 次から選択]**&#x200B;ドロップダウンリストから「**[!UICONTROL フォームデータモデル]**」を選択します。

   ![create-af-1-1](assets/create-af-1-1.png)

1. 「**[!UICONTROL フォームデータモデルを選択]**」をタップして展開します。すべての有効なフォームデータモデルが一覧表示されます。

   任意のフォームデータモデルを選択します。

   ![create-af-2-1](assets/create-af-2-1.png)

1. （**アダプティブフォームフラグメントのみ**）フォームデータモデル内の 1 つのデータモデルオブジェクトだけに基づいて、アダプティブフォームフラグメントを作成することができます。**[!UICONTROL フォームデータモデル定義]**&#x200B;ドロップダウンを展開します。指定したフォームデータモデル内のすべてのデータモデルオブジェクトがリスト表示されます。リストから、任意のデータモデルオブジェクトを選択します。

   ![create-af-3](assets/create-af-3.png)

フォームデータモデルに基づいてアダプティブフォームまたはアダプティブフォームフラグメントを作成すると、アダプティブフォームエディターのコンテンツブラウザーの「**[!UICONTROL データモデルオブジェクト]**」タブにフォームデータモデルオブジェクトが表示されます。

>[!NOTE]
>
>アダプティブフォームフラグメントの場合は、オーサリング時に選択したデータモデルオブジェクトと、そのオブジェクトに関連付けられているデータモデルオブジェクトだけが、「データモデルオブジェクト」タブに表示されます。

![data-model-objects-tab](assets/data-model-objects-tab.png)

データモデルオブジェクトをアダプティブフォームまたはアダプティブフォームフラグメントにドラッグアンドドロップすると、フォームフィールドを追加することができます。追加されたフォームフィールドには、メタデータのプロパティが保存されます。また、データモデルオブジェクトプロパティとのバインドに関する情報も保存されます。このバインド情報により、フォームの送信時に、対応するデータソース内のフィールド値が更新され、フォームのレンダリング時に、対応するデータソース内のフィールドに値が取り込まれます。

## インタラクティブ通信の作成 {#create-ic}

フォームデータモデルに基づいて、インタラクティブ通信を作成することができます。フォームデータモデルを使用して、設定済みデータソースのデータをインタラクティブ通信に事前に取り込むことができます。また、フォームデータモデルに基づいて、インタラクティブ通信の構築ブロック（テキスト、リストおよび条件のドキュメントフラグメントなど）を作成することができます。

インタラクティブ通信またはドキュメントフラグメントの作成時に、フォームデータモデルを選択することができます。以下の図は、インタラクティブ通信作成ダイアログの「一般」タブを示しています。

![create-ic](assets/create-ic.png)

インタラクティブ通信作成ダイアログの「一般」タブ

詳しくは、次を参照してください。

[インタラクティブ通信の作成](../../forms/using/create-interactive-communication.md)

[インタラクティブ通信内のテキスト](/help/forms/using/texts-interactive-communications.md)

[インタラクティブ通信内の条件](/help/forms/using/conditions-interactive-communications.md)

[リストフラグメント](/help/forms/using/lists.md)

## サンプルデータを使用したプレビュー {#preview-ic}

フォームデータモデルエディターでは、フォームデータモデル内のデータモデルオブジェクト用のサンプルデータを生成して編集することができます。このサンプルデータを使用して、インタラクティブ通信とアダプティブフォームのプレビュー表示とテストを実行することができます。プレビュー表示を行う前に、「[フォームデータモデルの操作](../../forms/using/work-with-form-data-model.md#sample)」の説明に従って、サンプルデータを生成する必要があります。

フォームデータモデルのサンプルデータを使用してインタラクティブ通信のプレビューを表示するには、以下の手順を実行します。

1. AEM オーサーインスタンスで、**[!UICONTROL フォーム／フォームとドキュメント]**&#x200B;に移動します。
1. インタラクティブ通信を選択してツールバーで「**[!UICONTROL プレビュー]**」をタップし、「**[!UICONTROL Web チャネル]**」、「**[!UICONTROL 印刷チャネル]**」、または「**[!UICONTROL 両方のチャネル]**」を選択します。これにより、選択したインタラクティブ通信のプレビューが表示されます。
1. プレビューの&#x200B;[*チャネル*]&#x200B;ダイアログで、「**[!UICONTROL フォームデータモデルのデータのテスト]**」が選択されていることを確認して「**[!UICONTROL プレビュー]**」をタップします。

サンプルデータが取り込まれた状態のインタラクティブ通信が表示されます。

![web-preview](assets/web-preview.png)

同様に、サンプルデータが取り込まれた状態のアダプティブフォームをプレビュー表示するには、作成者モードでアダプティブフォームを開いて「**[!UICONTROL プレビュー]**」をタップします。

## フォームデータモデルサービスを使用して事前にデータを取り込む {#prefill}

AEM Forms には、すぐに使用できるフォームデータモデル事前入力サービスが付属しています。フォームデータモデルに基づいて、このサービスをアダプティブフォームとインタラクティブ通信で使用することができます。この事前入力サービスは、アダプティブフォームとインタラクティブ通信内のデータモデルオブジェクトに対してデータソースのクエリーを実行し、フォームまたは通信のレンダリング時にデータを取り込みます。

アダプティブフォームに対してフォームデータモデル事前入力サービスを有効にするには、アダプティブフォームコンテナのプロパティを開き、基本アコーディオンの「**[!UICONTROL 事前入力サービス]**」ドロップダウンで「**[!UICONTROL フォームデータモデル事前入力サービス]**」を選択します。次に、各プロパティを保存します。

![prefill-service](assets/prefill-service.png)

インタラクティブ通信でフォームデータモデル事前入力サービスを設定するには、インタラクティブ通信の作成時に「事前入力サービス」ドロップダウンで「フォームデータモデル事前入力サービス」を選択します。後でプロパティを編集することもできます。

![edit-ic-props](assets/edit-ic-props.png)

インタラクティブ通信のプロパティ編集ダイアログ

## 送信されたアダプティブフォームのデータをデータソースに書き込む {#write-af}

ユーザーがフォームデータモデルに基づいてフォームを送信するとき、データモデルオブジェクトの送信データがそのデータソースに書き込まれるようにフォームを設定することができます。この設定を行うために、AEM Forms には、すぐに使用できる[フォームデータモデル送信アクション](../../forms/using/configuring-submit-actions.md)が用意されています。これは、フォームデータモデルをベースとするアダプティブフォーム専用のアクションです。これにより、データモデルオブジェクトに送信されたデータが、そのデータソースに書き込まれます。

フォームデータモデル送信アクションを設定するには、アダプティブフォームコンテナのプロパティを開き、送信アコーディオンの「送信アクション」ドロップダウンで「**[!UICONTROL フォームデータモデルを使用して送信]**」を選択します。次に、**[!UICONTROL 送信するデータモデルオブジェクトの名前]**&#x200B;ドロップダウンで、目的のデータモデルオブジェクトを探して選択します。各プロパティを保存します。

フォームを送信すると、設定されているデータモデルオブジェクトのデータが、各データソースに書き込まれます。

![data-submission](assets/data-submission.png)

バイナリデータモデルオブジェクトのプロパティを使用して、フォームの添付ファイルをデータソースに送信することもできます。添付ファイルを JDBC データソースに送信するには、以下の手順を実行します。

1. バイナリプロパティが含まれているデータモデルオブジェクトをフォームデータモデルに追加します。
1. アダプティブフォームで、「**[!UICONTROL 添付ファイル]**」コンポーネントをコンポーネントブラウザーからアダプティブフォームにドラッグ＆ドロップします。
1. 追加されたコンポーネントをタップして選択し、次に ![settings_icon](assets/settings_icon.png) をタップして、そのコンポーネントのプロパティブラウザーを開きます。
1. 「バインド参照」フィールドで ![foldersearch_18](assets/foldersearch_18.png) をタップし、フォームデータモデルに追加したバイナリプロパティに移動してそのプロパティを選択します。必要に応じて、他のプロパティを設定します。

   ![check-button](assets/check-button.png) をタップしてプロパティを保存します。この操作により、添付ファイルフィールドが、フォームデータモデルのバイナリプロパティにバインドされます。

1. アダプティブフォームコンテナプロパティの「送信」セクションで、「**[!UICONTROL フォームの添付ファイルを送信]**」を有効にします。これにより、フォームの送信時に、バイナリプロパティフィールド内の添付ファイルがデータソースに送信されるようになります。

## ルールを使用してアダプティブフォーム内のサービスを呼び出す {#invoke-services}

フォームデータモデルに基づくアダプティブフォームの場合、[ルールを作成](../../forms/using/rule-editor.md)して、フォームデータモデル内で設定されているサービスを呼び出すことができます。ルール内の「**[!UICONTROL サービスの呼び出し]**」操作を実行すると、フォームデータモデル内のすべての有効なサービスが一覧表示され、サービスの入力フィールドと出力フィールドを選択することができます。「**指定値**」というルールタイプを使用してフォームデータモデルサービスを呼び出し、そのサービスから返された出力に対するフィールドの値を設定することもできます。

例えば以下のルールの場合、従業員 ID を入力として使用する Get サービスが呼び出され、このサービスから返された値が、フォーム内の対応する扶養家族 ID フィールド、姓フィールド、名フィールド、性別フィールドに設定されます。

![invoke-service](assets/invoke-service.png)

また、`guidelib.dataIntegrationUtils.executeOperation` API を使用して、ルールエディターのコードエディターで JavaScript を記述することもできます。API について詳しくは、「[フォームデータモデルサービスを呼び出すための API](/help/forms/using/invoke-form-data-model-services.md)」を参照してください。
