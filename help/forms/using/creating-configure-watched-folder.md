---
title: 監視フォルダーの作成または設定
seo-title: 監視フォルダーの作成または設定
description: 監視フォルダーの作成または削除、既存の監視フォルダーのプロパティの変更方法について説明します。
seo-description: 監視フォルダーの作成または削除、既存の監視フォルダーのプロパティの変更方法について説明します。
uuid: 659d4d8c-99b8-40dd-b884-bfee4d476fe1
content-type: reference
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: publish
discoiquuid: 0ce7b338-6686-49b3-b58b-e7ab6b670708
translation-type: tm+mt
source-git-commit: 726163106ddb80600eaa7cc09b1a2e9b035a223e

---


# 監視フォルダーの作成または設定 {#create-or-configure-a-watched-folder}

管理者は、*監視フォルダー*&#x200B;と呼ばれるネットワークフォルダーを設定できます。ユーザーがファイル（PDF ファイルなど）を監視フォルダーに配置すると、設定済みの操作が開始され、ファイルが操作されます。指定の操作が実行されると、変更されたファイルが指定の出力フォルダーに保存されます。監視フォルダーの管理について詳しくは、[管理ヘルプ](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md)を参照してください。

監視フォルダーのユーザーインターフェイスを使用して次の操作を実行できます。

* 監視フォルダーの作成
* 既存の監視フォルダーのプロパティの更新
* 監視フォルダーの削除

## 監視フォルダーの作成 {#create-a-watched-folder}

監視フォルダーを設定する前に、以下を確認します。

* 監視フォルダーは AEM Forms の高度な機能です。使用するには、AEM Forms アドオンパッケージが必要です。適切な AEM Forms アドオンパッケージがインストールおよび設定されている必要があります。
* 共有ストレージまたはローカルストレージに監視フォルダーを作成できます。監視フォルダーを実行するように設定されている AEM Forms ユーザーは、監視フォルダーの読み取り権限と書き込み権限を持っている必要があります。
* サービス、ワークフロー、またはスクリプトを使用して、監視フォルダーの操作を自動化できます。対象のサービス、ワークフロー、またはスクリプトが作成されていて、実行可能な状態にある必要があります。For information about creating a Service, Workflow, and Script, see [Various methods of processing files](/help/forms/using/watched-folder-in-aem-forms.md#various-methods-for-processing-files).
* 監視フォルダーの各種プロパティについて詳しくは、「[監視フォルダーのプロパティ](watched-folder-in-aem-forms.md#watchedfolderproperties)」を参照してください。

次の手順を実行して、監視フォルダーを作成します。

1. 画面の左上隅にある **Adobe Experience Manager** アイコンをタップします。
1. **ツール**／**フォーム**／**監視フォルダーを設定をタップします。** 既に設定されている監視フォルダーのリストが表示されます。
1. 「**新規**」をタップします。監視フォルダーを作成するために必要なフィールドのリストが表示されます。

   * **名前**：監視フォルダーを識別します。名前には英数字のみを使用します。
   * **パス**：監視フォルダーの場所を指定します。クラスター環境では、クラスターの異なるノード上で AEM を実行しているすべてのユーザーにアクセス可能な共有ネットワークフォルダーを、この設定に指定する必要があります。
   * **次を使用してファイルを処理**：開始するプロセスのタイプです。ワークフロー、スクリプト、またはサービスを指定できます。
   * **サービス名/スクリプトパス/ワークフローパス**：このフィールドの動作は、「**次を使用してファイルを処理**」フィールドに指定されている値に基づきます。次の値を指定できます。

      * ワークフローに関しては、実行するワークフローモデルを指定します。例：/etc/workflow/models/&lt;workflow_name>/jcr:content/model
      * スクリプトに関しては、実行するスクリプトの JCR パスを指定します。例：/etc/watchfolder/test/testScript.ecma
      * サービスに関しては、OSGi サービスの特定に使用するフィルターを指定します。サービスは com.adobe.aemfd.watchfolder.service.api.ContentProcessor インターフェイスの実装として登録されます。例えば、以下のコードはカスタムの foo=bar プロパティを持つ ContentProcessor インターフェイスのカスタム実装です。
   >[!NOTE]
   >
   >「**次を使用してファイルを処理**」フィールドで「**サービス**」を選択した場合、「サービス名 (inputProcessorType) 」フィールドの値は括弧で囲む必要があります。例えば、(foo=bar) のように指定します。

   ```java
   @Component(metatype = true, immediate = true, label = "WF Test Service", description = "WF Test Service")
   @Service(value = {OutputWriter.class, ContentProcessor.class})
   @Property(name = "foo", value = "bar")
   public class OutputWriter implements ContentProcessor {
   ```

   * **出力ファイルパターン**：出力ファイルおよび出力フォルダーの名前と場所を決めるために監視フォルダーで使用されるパターンのセミコロン（;）区切りのリストを指定します。ファイルパターンについて詳しくは、「[ファイルパターンについて](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)」を参照してください。


1. 「**詳細設定**」をタップします。「詳細設定」タブには多数のフィールドが含まれています。これらのほとんどのフィールドにはデフォルトの値が指定されています。

   * **ペイロードマッパーフィルター：**&#x200B;監視フォルダーを作成すると、監視対象のフォルダーの中にフォルダー構造を作成します。フォルダー構造には stage、result、preserve、input、failure フォルダーが含まれます。このフォルダー構造はワークフローへの入力ペイロードとして使用され、ワークフローからの出力を受け取ります。また、失敗ポイントのリストも作成します（存在する場合）。ペイロードの構造は、監視フォルダーの構造とは異なります。監視フォルダーの構造をペイロードにマッピングするために、カスタムのスクリプトを作成することができます。このようなスクリプトは、ペイロードマッパーフィルターと呼ばれます。2 つのすぐに使える構築済みのペイロードマッパーの実装が利用可能です。[カスタムのマッパー実装](/help/forms/using/watched-folder-in-aem-forms.md#creating-a-custom-payload-mapper-filter)がない場合は、用意されている 2 つのマッパー実装のいずれかを使用してください。

      * **デフォルトのマッパー：**&#x200B;デフォルトのペイロードマッパーを使用して、監視フォルダーの入力と出力の内容をペイロード内の別々の入出力フォルダーに保存します。
      * **単純なファイルベースのペイロードマッパー：**&#x200B;入力と出力の内容をペイロードフォルダーに直接保存するには、単純なファイルベースのペイロードマッパーを使用してください。デフォルトのマッパーのような追加の階層は作成されません。
   * **実行モード**：ワークフローを実行する際に許可される実行モードのカンマ区切りのリストを指定します。
   * **次の一定時間後にステージファイルをタイムアウト**：入力ファイルまたは入力フォルダーが処理を開始してから、タイムアウト処理に失敗したと判定されるまでの待機時間の秒数を指定します。タイムアウトはこのプロパティの値が正である場合にのみ有効になります。
   * **スロットルの実行時にタイムアウトしたステージファイルを削除**：有効にすると、「**次の一定時間後にステージファイルをタイムアウト**」は、監視フォルダーでスロットルが有効にされている場合にのみ有効になります。
   * **次の間隔で入力フォルダーをスキャン**：監視フォルダーをスキャンして入力を確認する間隔（秒単位）を指定します。「ジョブ数を制限」設定が無効になっている場合、平均的なジョブの処理にかかる時間よりも長い時間をポーリング間隔に指定する必要があります。そうしないと、システムが過負荷になるおそれがあります。間隔の値には 1 以上を指定する必要があります。
   * **ファイルパターンを除外**：スキャンおよび取得の対象とするファイルとフォルダーを決めるために監視フォルダーで使用されるパターンのセミコロン（;）区切りのリストを指定します。指定したパターンに当てはまるファイルまたはフォルダーは、スキャンの対象外となります。ファイルパターンについて詳しくは、「[ファイルパターンについて](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)」を参照してください。
   * **ファイルパターンを含める**：スキャンおよび取得の対象とするファイルとフォルダーを決めるために監視フォルダーで使用されるパターンのセミコロン（;）区切りのリストを指定します。例えば、「ファイルパターンを含む」がinput&amp;ast；の場合、input&amp;ast；に一致するすべてのファイルとフォルダー拾い上げられます。 デフォルト値は&amp;ast；です。およびは、すべてのファイルとフォルダを示します。 For more information about file patterns, see [About File Patterns](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns).
   * **待機時間**：フォルダーまたはファイルの作成後にスキャンを実行するまでの待機時間（ミリ秒単位）を指定します。例えば、待機時間が 3,600,000 ミリ秒（1 時間）のときに、1 分前にファイルが作成されたとすると、59 分以上が経過した後でこのファイルが取得されます。デフォルト値は 0 です。

      この設定は、入力フォルダーにファイルまたはフォルダーのすべてのコンテンツがコピーされるようにする場合に役立ちます。例えば、処理するファイルのサイズが大きく、ファイルのダウンロードに10分かかる場合は、待機時間を10&amp;ast;60 &amp;ast;1000ミリ秒に設定します。 この間隔により、ファイルが作成されてから 10 分が経過していない場合は、監視フォルダーはそのファイルをスキャンしなくなります。

   * **次の日数よりも古い結果を削除**：ファイルまたはフォルダーを削除するまでに待機する時間を日数で指定します。指定した日数を経過すると削除されます。この設定は、結果フォルダーに常に空き容量を確保しておきたい場合に役立ちます。-1 を指定すると、結果フォルダーの削除は行われません。デフォルト値は -1 です。
   * **結果フォルダー名**：結果を保存するフォルダーの名前を指定します。結果がこのフォルダーに表示されない場合は、失敗フォルダーを確認してください。読み取り専用ファイルは処理されず、失敗フォルダーに保存されます。絶対パスまたは相対パスを、次のファイルパターンとともに使用できます。

      * %F = ファイル名プレフィックス
      * %E = ファイル拡張子
      * %Y = 年（4 桁表記）
      * %y = 年（下 2 桁）
      * %M = 月
      * %D = 日（1～31）
      * %d = 日（通日）
      * %H = 時（24 時間）
      * %h = 時（12 時間）
      * %m = 分
      * %s = 秒
      * %l = ミリ秒
      * %R = 乱数（0～9）
      * %P = プロセス ID またはジョブ ID
      * 例えば、2009 年 7 月 17 日午後 8 時で、C:/Test/WF0/failure/%Y/%M/%D/%H/ と指定した場合、結果のフォルダーは C:/Test/WF0/failure/2009/07/17/20 です。
      * 絶対パスではなく相対パスを指定すると、監視フォルダーの中に作成されます。デフォルト値は「result/%Y/%M/%D/」であり、監視フォルダー内の結果フォルダーです。ファイルパターンについて詳しくは、「[ファイルパターンについて](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)」を参照してください。
   * **失敗フォルダー名**：失敗ファイルが保存されるフォルダーを指定します。この場所は、常に監視フォルダーからの相対パスで指定します。「結果フォルダー」で説明したファイルパターンを使用できます。
   * **フォルダー名を保存**：正常にスキャンされ、取得されたファイルを保存するフォルダーを指定します。絶対パス、相対パス、または null のディレクトリパスを指定できます。「結果フォルダー」で説明したファイルパターンを使用できます。デフォルト値は「preserve/%Y/%M/%D/」です。
   * **バッチサイズ**：1 回のスキャンで取得されるファイルまたはフォルダーの数を指定します。システムが過負荷の状態になるのを防ぎます。一度にスキャンするファイル数が多すぎる場合、クラッシュする可能性があります。デフォルト値は 2 です。

      スキャンの間隔が小さいと、スレッドによって入力フォルダーが頻繁にスキャンされます。ファイルが頻繁に監視フォルダーに配置される場合は、スキャンの間隔を小さくする必要があります。ファイルが頻繁には配置されない場合は、他のサービスがスレッドを使用できるように、スキャンの間隔を大きくします。

   * **スロットルオン**：このオプションを有効にすると、AEM Forms で同時に処理できる監視フォルダーのジョブ数が制限されます。「バッチサイズ」の値によって、ジョブの最大数が決まります。詳しくは、「[ジョブ数の制限](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-throttling)」を参照してください。
   * **既存のファイルを類似する名前で上書き**：「True」に設定すると、結果フォルダーと保存用フォルダーにあるファイルが上書きされます。「False」に設定すると、ファイル名とフォルダー名の最後に数字のインデックスが付加されます。デフォルト値は False です。
   * **エラー時にファイルを保存**：「True」に設定すると、エラーが発生した場合に入力ファイルが保存されます。デフォルト値は true です。
   * **パターンを使用したファイルを含める**：スキャンおよび取得の対象とするフォルダーとファイルを決めるために監視フォルダーで使用されるパターンのセミコロン（;）区切りのリストを指定します。例えば、「ファイルパターンを含める」を入力すると、入力に一致するすべてのファイルとフォルダーが取得されます。 詳しくは、[管理ヘルプ](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md)を参照してください。
   * **監視フォルダを非同期的に呼び出す**：呼び出しを非同期型にするか同期型にするかを指定します。デフォルト値は「asynchronous」（非同期）です。長期間有効なプロセスでは非同期を使用し、一過性のプロセスまたは短期間のみ有効なプロセスでは同期を使用することをお勧めします。
   * **監視フォルダを有効化**：このオプションを有効にすると、監視フォルダが有効になります。デフォルト値は True です。



## 既存の監視フォルダーのプロパティの更新 {#modify-properties-of-an-existing-watched-folder}

監視フォルダーの名前の変更のほか、既存の監視フォルダーのすべてのプロパティを変更できます。次の手順を実行して、既存の監視フォルダーのプロパティを変更します。

1. 画面の左上隅にある **Adobe Experience Manager** アイコンをタップします。
1. **ツール**／**フォーム**／**監視フォルダーを設定をタップします。** 既に設定されている監視フォルダーのリストが表示されます。
1. 監視フォルダー画面の左側で、監視フォルダーを選択して&#x200B;**「編集」をタップします。**&#x200B;監視フォルダーを作成するために必要なフィールドのリストが表示されます。「**基本**」タブに表示されるフィールドは必須です。「詳細設定」タブには多数のフィールドが含まれています。これらのほとんどのフィールドにはデフォルトの値が指定されています。これらのプロパティは、必要に応じて変更できます。
1. プロパティを変更した後、「**更新**」をタップします。変更したプロパティが保存されます。

