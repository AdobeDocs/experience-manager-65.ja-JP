---
title: 監視フォルダーの作成または設定
seo-title: Create or Configure a watched folder
description: 監視フォルダーを作成または削除する方法、または既存の監視フォルダーのプロパティを変更する方法について説明します。
seo-description: Learn how to create or delete a watched folder, or modify the properties of an existing watched folder.
uuid: 659d4d8c-99b8-40dd-b884-bfee4d476fe1
content-type: reference
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: publish
discoiquuid: 0ce7b338-6686-49b3-b58b-e7ab6b670708
exl-id: b15d8d3b-5e47-4c33-95fe-440fcf96be83
source-git-commit: 38f0496d9340fbcf383a2d39dba8efcbdcd20c6f
workflow-type: tm+mt
source-wordcount: '1820'
ht-degree: 32%

---

# 監視フォルダーの作成または設定 {#create-or-configure-a-watched-folder}

管理者は、ネットワークフォルダー ( *監視フォルダー*&#x200B;を使用して、ユーザーがファイル (PDFファイルなど ) を監視フォルダーに配置したときに、事前設定済みの操作が開始され、ファイルが操作されます。 指定した操作が実行されると、変更したファイルが指定の出力フォルダに保存されます。 監視フォルダーの管理について詳しくは、 [管理ヘルプ](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md).

監視フォルダーのユーザーインターフェイスを使用して、次の操作を実行できます。

* 監視フォルダーの作成
* 既存の監視フォルダーのプロパティを変更する
* 監視フォルダーの削除

## 監視フォルダーの作成 {#create-a-watched-folder}

監視フォルダーを設定する前に、次の点を確認してください。

* 監視フォルダーは、AEM forms の高度な機能です。 機能するには、AEM forms アドオンパッケージが必要です。 適切なAEM Formsアドオンパッケージがインストールされ、設定されていることを確認します。
* 監視フォルダーは、共有ストレージまたはローカルストレージに作成できます。 監視フォルダーを実行するように設定されたAEM forms ユーザーに、監視フォルダーに対する読み取りおよび書き込み権限があることを確認します。
* サービス、ワークフロー、またはスクリプトを使用して、監視フォルダーでの操作を自動化できます。 対応するサービス、ワークフロー、またはスクリプトが作成され、実行する準備が整っていることを確認します。 サービス、ワークフロー、スクリプトについて詳しくは、「[さまざまなファイル処理方法](/help/forms/using/watched-folder-in-aem-forms.md#various-methods-for-processing-files)」を参照してください。
* 監視フォルダーには様々なプロパティがあります。詳しくは、 [監視フォルダーのプロパティ](watched-folder-in-aem-forms.md#watchedfolderproperties).

次の手順を実行して、監視フォルダーを作成します。

1. タップ **Adobe Experience Manager** アイコンをクリックします。
1. タップ **ツール** > **Forms** > **監視フォルダーを設定します。**&#x200B;既に設定されている監視フォルダーのリストが表示されます。
1. 「**新規**」をタップします。監視フォルダーの作成に必要なフィールドのリストが表示されます。

   * **名前**：監視フォルダーを識別します。 名前には英数字のみを使用します。
   * **パス**：監視フォルダーの場所を指定します。 クラスター環境では、クラスターの異なるノードでAEMを実行しているすべてのユーザーがアクセス可能な共有ネットワークフォルダーを、この設定で指定する必要があります。
   * **次を使用してファイルを処理**：開始するプロセスのタイプ。 ワークフロー、スクリプト、またはサービスを指定できます。
   * **サービス名／スクリプトパス/ワークフローパス**：このフィールドの動作は、「**次を使用してファイルを処理**」フィールドに指定されている値に基づきます。次の値を指定できます。

      * 「ワークフロー」で、実行するワークフローモデルを指定します。 例： /etc/workflow/models/&lt;workflow_name>/jcr:content/model
      * 「スクリプト」に、実行するスクリプトの JCR パスを指定します。 例： /etc/watchfolder/test/testScript.ecma
      * サービスの場合は、OSGi サービスの特定に使用するフィルターを指定します。 サービスは com.adobe.aemfd.watchfolder.service.api.ContentProcessor インターフェイスの実装として登録されます。例えば、以下のコードはカスタムの foo=bar プロパティを持つ ContentProcessor インターフェイスのカスタム実装です。

   >[!NOTE]
   >
   >次を選択した場合、 **サービス** （の） **次を使用してファイルを処理** 「 」フィールドに値を入力する場合は、「サービス名 (inputProcessorType) 」フィールドの値を括弧で囲む必要があります。 例えば、(foo=bar) のように指定します。

   ```java
   @Component(metatype = true, immediate = true, label = "WF Test Service", description = "WF Test Service")
   @Service(value = {OutputWriter.class, ContentProcessor.class})
   @Property(name = "foo", value = "bar")
   public class OutputWriter implements ContentProcessor {
   ```

   * **出力ファイルパターン**：出力ファイルおよび出力フォルダーの名前と場所を決定する際に監視フォルダーで使用されるパターンのセミコロン (;) 区切りのリストを指定します。 ファイルパターンについて詳しくは、「[ファイルパターンについて](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)」を参照してください。

1. タップ **詳細**. 「詳細設定」タブには、さらに多くのフィールドが含まれています。 これらのほとんどのフィールドにはデフォルトの値が指定されています。

   * **ペイロードマッパーフィルター：** 監視フォルダーを作成すると、監視対象のフォルダー内にフォルダー構造が作成されます。 フォルダー構造には、stage、result、preserve、input および failure の各フォルダーが含まれます。 フォルダー構造は、ワークフローへの入力ペイロードとして機能し、ワークフローからの出力を受け取ることができます。 また、障害点がある場合は、そのリストを表示できます。 ペイロードの構造は、監視フォルダーの構造とは異なります。 監視フォルダーの構造をペイロードにマッピングするカスタムスクリプトを作成できます。 このようなスクリプトは、ペイロードマッパーフィルターと呼ばれます。 標準搭載の 2 つのペイロードマッパー実装を使用できます。 次の条件を満たしていない場合、 [カスタム実装](/help/forms/using/watched-folder-in-aem-forms.md#creating-a-custom-payload-mapper-filter)で、標準搭載の実装の 1 つを使用します。

      * **デフォルトのマッパー：**&#x200B;デフォルトのペイロードマッパーを使用して、監視フォルダーの入力と出力の内容をペイロード内の別々の入出力フォルダーに保存します。
      * **単純なファイルベースのペイロードマッパー：**&#x200B;入力と出力の内容をペイロードフォルダーに直接保存するには、単純なファイルベースのペイロードマッパーを使用してください。デフォルトのマッパーなど、余分な階層は作成されません。

   * **実行モード**：ワークフローの実行に許可される実行モードのコンマ区切りリストを指定します。
   * **次の後にステージファイルをタイムアウト**：処理のために既に取得された入力ファイルまたは入力フォルダーがタイムアウトしたと見なされて失敗と見なされるまでの待機時間（秒数）を指定します。 タイムアウトメカニズムは、このプロパティの値が正の数の場合にのみ有効になります。
   * **スロットルの実行時にタイムアウトしたステージファイルを削除**：有効にすると、「**次の一定時間後にステージファイルをタイムアウト**」は、監視フォルダーでスロットルが有効にされている場合にのみ有効になります。
   * **次の間隔で入力フォルダーをスキャン：**&#x200B;監視フォルダーをスキャンして入力を確認する間隔（秒単位）を指定します。「スロットル」設定が有効になっていない場合は、ポーリング間隔は平均ジョブを処理する時間より長くする必要があります。そうしないと、システムが過負荷になる可能性があります。 間隔の値は 1 以上である必要があります。
   * **ファイルパターンを除外**：スキャンおよび取得の対象となるファイルとフォルダーを決定するために監視フォルダーで使用されるパターンのセミコロン (;) 区切りのリストを指定します。 指定されたパターンを持つファイルまたはフォルダは、スキャンされて処理されません。 ファイルパターンについて詳しくは、「[ファイルパターンについて](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)」を参照してください。
   * **ファイルパターンを含める**：スキャンおよび取得の対象とするファイルとフォルダーを決めるために監視フォルダーで使用されるパターンのセミコロン（;）区切りのリストを指定します。例えば、「ファイルパターンを含める」が「input&amp;ast;」の場合、名前が input&amp;ast; に一致するすべてのファイルおよびフォルダーが取得されます。デフォルト値は &amp;ast; です。すべてのファイルとフォルダーが対象となります。ファイルパターンについて詳しくは、「[ファイルパターンについて](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)」を参照してください。
   * **待機時間：**&#x200B;フォルダーまたはファイルの作成後にスキャンを実行するまでの待機時間（ミリ秒単位）を指定します。例えば、待機時間が 3,600,000 ミリ秒（1 時間）で、1 分前にファイルが作成された場合、このファイルは 59 分以上経過した後に取得されます。 デフォルト値は 0 です。

     この設定は、ファイルまたはフォルダーのすべてのコンテンツを入力フォルダーにコピーする場合に役立ちます。 例えば、処理の対象となるファイルサイズが大きく、そのファイルをダウンロードするのに 10 分かかる場合は、待機時間を 10 x 60 x 1000 ミリ秒に設定します。この間隔により、ファイルが作成されてから 10 分が経過していない場合は、監視フォルダーはそのファイルをスキャンしなくなります。

   * **次の日数よりも古い結果を削除：**&#x200B;ファイルやフォルダーを削除するまでに待機する時間を日数で指定します。この設定は、結果フォルダーがいっぱいにならないようにするのに役立ちます。 -1 日の値は、結果フォルダーを削除しないことを示します。 デフォルト値は -1 です。
   * **結果フォルダー名：**&#x200B;結果を保存するフォルダーの名前を指定します。結果がこのフォルダーに表示されない場合は、失敗フォルダーを確認します。 読み取り専用ファイルは処理されず、失敗フォルダーに保存されます。 絶対パスまたは相対パスを使用して、次のファイルパターンを指定できます。

      * %F =ファイル名のプレフィックス
      * %E =ファイル名の拡張子
      * %Y =年（全角）
      * %y =年（下 2 桁）
      * %M =月
      * %D =日（月）
      * %d =日（通日）
      * %H =時（24 時間）
      * %h =時（12 時間）
      * %m =分
      * %s =秒
      * %l =ミリ秒
      * %R =乱数 (0 ～ 9)
      * %P =プロセスまたはジョブ ID
      * 例えば、2009 年 7 月 17 日の午後 8 時で、C:/Test/WF0/failure/%Y/%M/%D/%H/と指定した場合、結果のフォルダは C:/Test/WF0/failure/2009/07/17/20 になります。
      * 絶対パスではなく相対パスを指定した場合、そのフォルダーは監視フォルダー内に作成されます。 デフォルト値は result/%Y/%M/%D/です。これは、監視フォルダー内の結果フォルダーです。 ファイルパターンについて詳しくは、「[ファイルパターンについて](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-file-patterns)」を参照してください。

   * **失敗フォルダー名**：失敗ファイルが保存されるフォルダーを指定します。この場所は、常に監視フォルダーからの相対パスで指定します。「結果フォルダ」の説明に従って、ファイルパターンを使用できます。
   * **フォルダー名を保存**：正常にスキャンされ、取得されたファイルを保存するフォルダーを指定します。パスは、絶対ディレクトリ、相対ディレクトリ、または null ディレクトリにすることができます。 「結果フォルダ」の説明に従って、ファイルパターンを使用できます。 デフォルト値は preserve/%Y/%M/%D/です。
   * **バッチサイズ**：1 回のスキャンで取得されるファイルまたはフォルダーの数を指定します。これにより、システムの負荷が大きくなるのを防ぎます。一度にスキャンするファイルが多すぎると、クラッシュが発生する可能性があります。 デフォルト値は 2 です。

     スキャン間隔が小さい場合、スレッドは入力フォルダーを頻繁にスキャンします。 ファイルが頻繁に監視フォルダーに配置される場合は、スキャンの間隔を小さくする必要があります。 ファイルが頻繁に配置されない場合は、他のサービスがスレッドを使用できるように、より大きなスキャン間隔を使用します。

   * **スロットルオン：** このオプションを有効にすると、AEM forms で同時に処理できる監視フォルダーのジョブ数が制限されます。 「バッチサイズ」の値によって、ジョブの最大数が決まります。 詳しくは、 [スロットリング](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md#about-throttling)
   * **既存のファイルを類似の名前で上書き**:「True」に設定すると、結果フォルダーと保存用フォルダー内のファイルが上書きされます。 False に設定すると、名前には数値インデックスサフィックスを持つファイルおよびフォルダが使用されます。 デフォルト値は False です。
   * **失敗時にファイルを保存：** True に設定すると、失敗した場合は入力ファイルが保持されます。 デフォルト値は true です。
   * **パターンを使用したファイルを含める**：スキャンおよび取得の対象とするフォルダーとファイルを決めるために監視フォルダーで使用されるパターンのセミコロン（;）区切りのリストを指定します。例えば、「ファイルパターンを含める」が「input*」の場合、名前が input* に一致するすべてのファイルおよびフォルダーが取得されます。詳細情報については、[管理ヘルプ](/help/forms/using/admin-help/configuring-watched-folder-endpoints.md)を参照してください。
   * **監視フォルダーを非同期的に呼び出す**：呼び出しを非同期型にするか同期型にするかを指定します。デフォルト値は asynchronous（非同期）です。長期間有効なプロセスでは非同期を、一時的なプロセスまたは短時間有効なプロセスでは同期をお勧めします。
   * **監視フォルダーを有効にする：** このオプションを有効にすると、監視フォルダーが有効になります。 デフォルト値は True です。

## 既存の監視フォルダーのプロパティを変更する {#modify-properties-of-an-existing-watched-folder}

監視フォルダーの名前を変更する以外に、既存の監視フォルダーのすべてのプロパティを変更することができます。 次の手順を実行して、既存の監視フォルダーのプロパティを変更します。

1. 次をタップします。 **Adobe Experience Manager** アイコンをクリックします。
1. タップ **ツール** > **Forms** > **監視フォルダーを設定します。**&#x200B;既に設定されている監視フォルダーのリストが表示されます。
1. 監視フォルダー画面の左側で、監視フォルダーを選択して&#x200B;**「編集」をタップします。**&#x200B;監視フォルダーを作成するために必要なフィールドのリストが表示されます。「**基本**」タブに表示されるフィールドは必須です。「詳細設定」タブには、さらに多くのフィールドが含まれています。 これらのほとんどのフィールドにはデフォルトの値が指定されています。必要に応じて、これらのプロパティを変更できます。
1. プロパティを変更したら、 **更新**. 変更したプロパティが保存されます。
