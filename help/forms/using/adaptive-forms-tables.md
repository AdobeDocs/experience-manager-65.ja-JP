---
title: アダプティブフォームにおける表
description: AEM Forms のテーブルコンポーネントを使用すると、アダプティブフォームでモバイルレイアウトに対応するテーブルを作成でき、XDP テーブルコンポーネントも使用できるようになります。
topic-tags: author
products: SG_EXPERIENCEMANAGER/6.5/FORMS
docset: aem65
feature: Adaptive Forms, Foundation Components
exl-id: 1a139530-27bd-44da-8bf4-5b375e75cf32
solution: Experience Manager, Experience Manager Forms
role: User, Developer
source-git-commit: f6771bd1338a4e27a48c3efd39efe18e57cb98f9
workflow-type: ht
source-wordcount: '2459'
ht-degree: 100%

---

# アダプティブフォームのテーブル{#tables-in-adaptive-forms}

<span class="preview">[アダプティブフォームの新規作成](/help/forms/using/create-an-adaptive-form-core-components.md)または [AEM Sites ページへのアダプティブフォームの追加](/help/forms/using/create-or-add-an-adaptive-form-to-aem-sites-page.md)には、最新の拡張可能なデータキャプチャ[コアコンポーネント](https://experienceleague.adobe.com/docs/experience-manager-core-components/using/adaptive-forms/introduction.html?lang=ja)を使用することをお勧めします。これらのコンポーネントは、アダプティブフォームの作成における大幅な進歩を表し、ユーザーエクスペリエンスの向上を実現します。この記事では、基盤コンポーネントを使用してアダプティブフォームを作成する古い方法について説明します。</span>

| バージョン | 記事リンク |
| -------- | ---------------------------- |
| AEM as a Cloud Service | [ここをクリックしてください](https://experienceleague.adobe.com/docs/experience-manager-cloud-service/content/forms/adaptive-forms-authoring/authoring-adaptive-forms-foundation-components/add-components-to-an-adaptive-form/adaptive-forms-tables.html?lang=ja) |
| AEM 6.5 | この記事 |


複雑なデータであっても、テーブルを使用することで、効果的かつシンプルにまとめて提示できます。情報をわかりやすく配置し、行と列に分けて規則正しく配列することで、ユーザーも入力しやすくなります。金融サービスや政府機関が提供するフォームの大部分は、数字を入力して計算を実行できる大規模なデータテーブルを必要とします。

AEM Forms では、サイドバーのコンポーネントブラウザーにテーブルコンポーネントが用意されており、アダプティブフォーム内でテーブルを作成できます。主な機能には、以下のようなものがあります。

* モバイルデバイス上のレスポンシブなレイアウト
* 設定可能な行と列
* 実行時の動的な追加と削除
* セルの結合と分割
* スクリーンリーダーによるアクセス
* CSS を使用したカスタムレイアウト
* XDP テーブルコンポーネントとの互換性とマッピング
* XSD 複合タイプ要素を使用した行またはセルの追加のサポート
* XML ファイルからのデータの結合

## テーブルの作成 {#create-a-table}

テーブルを作成するには、テーブルコンポーネントをサイドキックのコンポーネントブラウザーからアダプティブフォームにドラッグ＆ドロップします。テーブルには、デフォルトで 2 つの列とヘッダー行を含む 3 つの行が含まれています。

![AEM サイドバーのテーブルコンポーネント](assets/sidebar-tables.png)

### ヘッダーと本文セルについて {#about-header-and-body-cells}

ヘッダーセルは、テキストフィールドです。ヘッダーのラベルを変更するには、ヘッダーセルを右クリックし、「**編集**」をクリックします。編集ダイアログの「**値**」フィールドのラベルを編集して、「**OK**」をクリックします。

ボディセルは、デフォルトでテキストボックスになっています。ボディセルは、サイドキックで使用可能な他のアダプティブフォームコンポーネント（数値ボックス、日付選択、ドロップダウンリストなど）に置き換えることができます。

例えば、以下のテーブルの最初のボディ行には、テキストボックス、日付選択、ドロップダウンリストのコンポーネントがセルとして含まれています。

![行セルのタイプ](assets/row-cell-types.png)

結合したいセルを選択し、右クリックして「**結合**」を選択することで、複数のセルを結合できます。また、結合されたセルを右クリックして「**セルの分割**」を選択することで、セルを分割できます。

### 行および列の追加、削除、移動 {#add-delete-move-rows-and-columns}

テーブルの行または列を追加／削除したり、行を上下に移動させることができます。

行または列を追加／削除する、または行を移動させるには、行または列に含まれるセルのいずれかをクリックします。列の一番上および行の左側にドロップダウンメニューが表示されます。上部のメニューには列を追加または削除するオプションが表示され、左側のメニューには行を追加、削除または移動させるオプションが表示されます。

* 追加の操作では、選択された行の下に行が、そして選択された列の右隣に列が追加されます。
* 削除の操作では、選択された行または列が削除されます。
* 上へ移動または下へ移動の操作は、選択された行を上下に移動させます。

行のドロップダウンメニューでは、行のプロパティ、設定、スタイル設定オプションを編集する編集操作も提供されます。

![add-delete-move-row-column](assets/add-delete-move-row-column.png)

>[!NOTE]
>
>テーブルには、任意の数の行を追加できますが、追加できる列の数は最大 6 つまでに制限されています。また、テーブルからヘッダー行を削除することはできません。

### テーブルの説明の追加 {#add-table-description}

情報がどのように整理されているか、スクリーンリーダーが解釈し、読み出すことのできる説明を、テーブルに追加できます。説明を追加するには、以下の手順を実行します。

1. テーブルを選択して ![cmppr](assets/cmppr.png) を選択し、プロパティをサイドバーに表示します。
1. 「アクセシビリティ」タブで概要を指定します。
1. 「**完了**」をクリックします。

### テーブルの列の並べ替え {#sortcolumnstable}

アダプティブフォームでは、テーブルの任意の列を基準にデータを並べ替えることができます。列の値は、昇順または降順で並べ替えることができます。

並べ替えは、以下の項目を含むテーブルの列に適用できます。

* 静的テキスト
* データモデルオブジェクトプロパティ
* 静的テキストとデータモデルオブジェクトプロパティの組み合わせ

テーブルの列に並べ替えを適用するには、数値ボックス、数値ステッパー、日付入力フィールド、日付選択、テキスト、テキストボックスのうち、いずれかのコンポーネントがテーブルの列のセルに含まれている必要があります。

並べ替えを有効にするには、以下の手順を実行します。

1. テーブルを選択し、![configure_icon](assets/configure_icon.png)（設定）を選択します。インタラクティブ通信のサイドキックにある&#x200B;**コンテンツ**&#x200B;ブラウザーを使用して、テーブルを選択することもできます。
1. 「**並べ替えを有効にする**」を選択します。
1. ![done_icon](assets/done_icon.png) を選択して、テーブルプロパティを保存します。列ヘッダー内の並べ替えアイコンの上向き矢印と下向き矢印は、並べ替えが有効になっていることを表します。

   ![並べ替えを有効にする](assets/enable_sorting_new.png)

1. **プレビュー**&#x200B;モードに切り替えて、出力を表示します。テーブルは、テーブルの最初の列に基づいて自動的に並べ替えられます。
1. 列ヘッダーをクリックして、列に基づいて値を並べ替えます。

   上向き矢印の付いた列ヘッダーは、その列に基づいてテーブルが並べ替えられていることを表します。さらに、列の値が昇順で表示されます。

   ![昇順での並べ替え](assets/sorting_ascending_new.png)

   同様に、下向き矢印の付いた列見出しは、列内の値が降順で表示されていることを表します。

   また、**プレビュー**&#x200B;モードでテーブルを変更し、列見出しをもう一度クリックして、列の値を並べ替えることもできます。

## テーブルの列幅の設定 {#set-column-width}

テーブルの列幅を設定するには、次の手順を実行します。

1. 「**[!UICONTROL コンテンツ]**」タブで、**[!UICONTROL テーブル]**&#x200B;コンポーネントを選択し、「設定」（![設定](assets/configure-icon.svg)）アイコンをタップします。

1. 「**[!UICONTROL 列幅]**」フィールドに値のコンマ区切りリストを入力して、テーブルの各列の比例する幅を指定します。例えば、3 つの列を含むテーブルの場合、「**[!UICONTROL 列幅]**」フィールドの値で 2、4、6 を指定すると、1 列目の幅は 2/12、2 列目は 4/12、3 列目は 6/12 に設定されます。最初の列の幅である 2/12 は、テーブル幅の 6 分の 1 を表します。同様に、4/12 は 2 番目の列の幅をテーブル幅の 3 分の 1 に設定し、6/12 は 3 番目の列の幅をテーブル幅の半分に設定します。

## テーブルのスタイルの設定 {#configure}

ページツールバーでスタイルモードを使用することで、テーブルのスタイルを定義できます。以下の手順を実行して、スタイルモードに切り替え、テーブルのスタイルを編集します。

1. ページのツールバーで、プレビューを実行する前に、![canvas-drop-down](assets/canvas-drop-down.png)／**スタイル**&#x200B;を選択します。

1. サイドバーでテーブルを選択し、「編集」ボタン ![edit-button](assets/edit-button.png) を選択します。
サイドバーにスタイルプロパティが表示されます。

![テーブルのスタイルプロパティ](assets/style-table.png)

>[!NOTE]
>
>ヘッダーおよびボディ行のカラーテーマは、LESS 変数の値を変更することで変更できます。詳しくは、[AEM Forms のテーマ](/help/forms/using/themes.md)を参照してください。

## 動的に行を追加または削除する {#add-or-delete-a-row-dynamically}

テーブルには、実行時の動的な行の追加および削除のサポートがあらかじめ含まれています。

1. テーブルの行を選択し、![cmppr](assets/cmppr.png) を選択します。
1. 「設定を繰り返し」タブで、テーブルの行の数を制限する最大値と最小値を指定します。
1. 「**完了**」をクリックします。

実行時に、行を追加／削除するための **+** と *-* ボタンが表示されます。

![add-delete-rows-dynamically](assets/add-delete-rows-dynamically.png)

>[!NOTE]
>
>行の動的な追加／削除は、テーブルの「左側にヘッダー」のモバイルレイアウトではサポートされていません。

## テーブルの式 {#expressions-in-a-table}

アダプティブフォームのテーブルでは、表または行の表示／非表示、すべての数値を加算したセル内の合計表示、セルの有効化または無効化、ユーザー入力の検証などの動作を誘導する式を JavaScript で作成できます。これらの式は、アダプティブフォームのスクリプトモデル API を使用します。

テーブルと行では、式によって返される値を基にその表示をコントロールする表示式のみがサポートされていますが、セルでは、以下の式がサポートされています。

* **初期化スクリプト：**&#x200B;フィールドの初期化時にアクションを実行します。
* **値コミットスクリプト：**&#x200B;フィールドの値が変更された後でフォームのコンポーネントを変更します。

>[!NOTE]
>
>同じフィールドに XFA change/exit スクリプトも適用されている場合は、値コミットスクリプトの前に XFA change/exit スクリプトが実行されます。

* **式の計算**：フィールドの値を自動計算します。
* **検証式**：フィールドを検証します。
* **アクセス式**：フィールドを有効／無効にします。
* **表示式**：フィールドおよびパネルの表示をコントロールします。

テーブルまたは行の表示の式は、対応する編集コンポーネントダイアログの「パネルプロパティ」タブで定義できます。セルの式は、編集コンポーネントダイアログの「スクリプト」タブで定義できます。

アダプティブフォームのクラス、イベント、オブジェクトおよびパブリック API の完全なリストについては、[アダプティブフォーム用 JavaScript ライブラリ API リファレンス](https://helpx.adobe.com/jp/experience-manager/6-5/forms/javascript-api/index.html)を参照してください。

## モバイルレイアウト {#mobile-layouts}

アダプティブフォームのテーブルは、レイアウトの流動性と応答性に優れており、モバイルデバイス上で比類のないエクスペリエンスを提供します。AEM Forms には、テーブル用のモバイルレイアウトとして、「左側にヘッダー」と「折りたたみ可能な列」の 2 種類が用意されています。

テーブルのモバイルレイアウトは、テーブルの編集コンポーネントダイアログの「スタイル設定」タブから設定できます。

### 左側にヘッダー {#headers-on-left}

左側にヘッダーのレイアウトでは、テーブルのヘッダーが左側に転置され、ヘッダーに寄せてセルがひとつだけ表示されている形になっています。このレイアウトでの各行は、個別のセクションとして表示されます。以下の画像では、デスクトップ上でのテーブルとモバイルデバイス上でのテーブルを比較しています。

![デスクトップビュー](assets/desktopview_new.png)

左側にヘッダーのレイアウトを使用したテーブルのデスクトップビュー

![左側にヘッダー](assets/headersontheleft_new.png)

左側にヘッダーのレイアウトを使用したテーブルのモバイルビュー

### 折りたたみ可能な列のレイアウト {#collapsible-columns-layout}

折りたたみ可能な列のレイアウトでは、デバイスの大きさによって 1 つまたは 2 つの列が表示され、その他の列は折りたたまれます。折りたたみ／展開アイコンをクリックすると、テーブルの他の列を表示できます。

>[!NOTE]
>
>折りたたみ可能な列のレイアウトはモバイルデバイス向けに最適化されていますが、テーブルの中のすべての列を表示するのに十分な幅がない場合に、デスクトップにも使用できます。

以下の画像では、列が折りたたまれた状態と展開された状態で、テーブルがどのように表示されるかを比較しています。

![折りたたまれた列](assets/collapsed-column.png)

モバイルデバイス上で、列が 2 つだけ表示されているテーブルの中の折りたたまれた列

![collapsible_column](assets/collapsible_column.png)

モバイルデバイス上で展開されたテーブルの列

## テーブルでのデータの結合 {#merge-data-in-a-table}

アダプティブフォームのテーブルを使用すると、実行時に、XML ファイルのデータを使用してテーブルにデータを入力することができます。データ XML ファイルは、AEM Forms サーバーが稼動しているマシンのローカルファイルシステム、または CRX リポジトリに置くことができます。

XML ファイルからのデータを使って銀行取引概略表に入力する例を次に示します。

![data-merge-table](assets/data-merge-table.png)

この例で使用する要素名プロパティを以下に示します。

* 行：**Row1**
* 取引日の下のボディセル：**tableItem1**
* 説明の下のボディセル：**tableItem2**
* 取引の種類の下のボディセル：**type**
* 金額（USD）の下のボディセル：**tableItem3**

以下の形式のデータを含む XML ファイル：

```xml
<?xml version="1.0" encoding="UTF-8"?><afData>
  <afUnboundData>
    <data>
 <typeSelect>0</typeSelect>
 <Row1>
      <tableItem1>2015-01-08</tableItem1>
      <tableItem2>Purchase laptop</tableItem2>
      <type>0</type>
      <tableItem3>12000</tableItem3>
 </Row1>
 <Row1>
      <tableItem1>2015-01-05</tableItem1>
      <tableItem2>Transport expense</tableItem2>
      <type>0</type>
      <tableItem3>120</tableItem3>
 </Row1>
 <Row1>
      <tableItem1>2014-01-08</tableItem1>
      <tableItem2>Laser printer</tableItem2>
      <type>0</type>
      <tableItem3>500</tableItem3>
 </Row1>
 <Row1>
      <tableItem1>2014-12-08</tableItem1>
      <tableItem2>Credit card payment</tableItem2>
      <type>0</type>
      <tableItem3>300</tableItem3>
 </Row1>
 <Row1>
      <tableItem1>2015-01-06</tableItem1>
      <tableItem2>Interest earnings</tableItem2>
      <type>1</type>
      <tableItem3>12000</tableItem3>
 </Row1>
 <Row1>
      <tableItem1>2015-01-05</tableItem1>
      <tableItem2>Payment from a client</tableItem2>
      <type>1</type>
      <tableItem3>500</tableItem3>
 </Row1>
 <Row1>
      <tableItem1>2015-01-08</tableItem1>
      <tableItem2>Food expense</tableItem2>
      <type>0</type>
      <tableItem3>120</tableItem3>
 </Row1>
 </data>
  </afUnboundData>
  <afBoundData>
    <data/>
  </afBoundData>
  <afBoundData/>
</afData>
```

サンプル XML では、行のデータは、テーブルの行の要素名である `<Row1>` タグによって定義されています。`<Row1>` タグ内では、各セルのデータは、タグ内の `<tableItem1>`、`<tableItem2>`、`<tableItem3>`、`<type>` などの要素名で定義されています。

このデータを実行時にテーブルと統合するには、wcmmode を無効にした状態で、XML の絶対位置をテーブルを含むアダプティブフォームに示す必要があります。例えば、アダプティブフォームが *https://localhost:4502/myForms/bankTransaction.html* にあり、データ XML ファイルが *C:/myTransactions/bankSummary.xml* に保存されている場合、データが入ったテーブルは次の URL で確認することができます。

*https://localhost:4502/myForms/bankTransaction.html?dataRef=file:/// C:/myTransactions/bankSummary.xml&amp;wcmmode=disabled*

![data-merged-table](assets/data-merged-table.png)

## XDP コンポーネントおよび XSD 複合タイプの使用 {#use-xdp-components-and-xsd-complex-types}

XFA フォームテンプレートに基づいてアダプティブフォームを作成した場合、XFA 要素は AEM コンテンツファインダーの「データモデル」タブで使用できます。テーブルを含むこれらの XFA 要素は、アダプティブフォームにドラッグ＆ドロップできます。

XFA のテーブル要素はテーブルコンポーネントにマッピングされており、アダプティブフォームですぐに使用できます。XDP テーブルのすべてのプロパティおよび機能は、アダプティブフォームに移動しても保持されるので、ネイティブのアダプティブフォームのテーブルと同様にあらゆる操作を実行できます。例えば、XDP テーブルの行が繰り返し可能とマークされている場合、これはアダプティブフォームにドロップされた場合にも繰り返されます。

さらに、XDP サブフォームをドラッグ＆ドロップして、新しい行をテーブルに追加することもできます。ただし、階層化されたサブフォームをドロップすることはできませんので注意してください。

>[!NOTE]
>
>ヘッダー行のない XDP テーブルは、アダプティブフォームのテーブルコンポーネントにマッピングされません。代わりに、流動的なレイアウトをを使用してアダプティブフォームのパネルコンポーネントにマッピングされます。また、ネストされたテーブルを XDP からアダプティブフォームに追加すると、内部テーブルを保持したまま、外部テーブルがパネルに変換されます。

さらに、XSD 複合タイプ要素のグループをドラッグ＆ドロップし、テーブルの行を作成できます。要素をドロップした行のすぐ下に、新しい行が作成されます。XSD 複合タイプ要素を使用して作成されたセルは、XSD への連結参照を維持します。また、セルに要素をドロップすることで、ボディセルを XSD 複合タイプ要素で置き換えることもできます。

>[!NOTE]
>
>XDP テーブルコンポーネント（サブフォーム）または XSD 複合タイプ内の要素の数は、行内のセルの数を超えることはできません。例えば、セルが 3 つしかない行に、4 つの要素をドロップすることはできません。これは、エラーとなります。
>
>要素数が行内のセルの数より少ない場合、要素に基づいたセルが新しい行にまず追加され、その後、行内の残りのセルに入力するためにデフォルトのセルが追加されます。例えば、3 つの要素のグループを 4 つのセルを持つ行にドロップした場合、最初の 3 つのセルはドロップされた要素に基づくセルとなり、残りの 1 つのセルはテーブルのデフォルトのセルになります。

## 主な考慮事項 {#key-considerations}

* XSD ベースのテーブルの作成中に行を上下に移動させると、フォームの送信時に、テーブルの行から、XML によって生成されたデータのデータ損失が見られます。
* デフォルトのテーブルの各ボディセルには、事前に定義された要素名が関連付けられています。アダプティブフォームに別のテーブルを追加すると、新しいテーブルのデフォルトのボディセルには、最初のテーブルと同じ要素名が割り当てられます。このようなケースでは、フォームの送信時に生成されるデータに、どちらかひとつのテーブルのデフォルトのボディセルのデータのみが含まれることになります。そのため、テーブルをまたいで一意の名前になるようにデフォルトのボディセルの要素名を変更し、データ損失を避けるようにしてください。

  これは、デフォルトのボディセルにのみ該当します。テーブルに行または列を追加すると、デフォルト以外のボディセルに対して、一意の要素名が自動生成されます。
