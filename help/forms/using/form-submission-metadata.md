---
title: ユーザーデータからフォーム送信メタデータへの情報の追加
seo-title: Adding information from user data to form submission metadata
description: ユーザーが提供したデータを使用して、送信済みフォームのメタデータに情報を追加する方法を学習します。
seo-description: Learn how to add information to metadata of a submitted form with user provided data.
uuid: c3eea3c0-31f8-4bf8-b5cf-34f907bdbdba
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: develop
discoiquuid: 2c971da0-5bd5-40d1-820d-4efc2a44b49d
docset: aem65
feature: Adaptive Forms
exl-id: 5ca850e3-30f0-4384-b615-356dc3c2ad0d
source-git-commit: bd86d647fdc203015bc70a0f57d5b94b4c634bf9
workflow-type: tm+mt
source-wordcount: '740'
ht-degree: 53%

---

# ユーザーデータからフォーム送信メタデータへの情報の追加{#adding-information-from-user-data-to-form-submission-metadata}

<span class="preview"> Adobeでは、最新の拡張可能なデータキャプチャを使用することをお勧めします [コアコンポーネント](https://experienceleague.adobe.com/docs/experience-manager-core-components/using/adaptive-forms/introduction.html?lang=ja) 対象： [新しいアダプティブFormsの作成](/help/forms/using/create-an-adaptive-form-core-components.md) または [AEM SitesページへのアダプティブFormsの追加](/help/forms/using/create-or-add-an-adaptive-form-to-aem-sites-page.md). これらのコンポーネントは、アダプティブフォームの作成における大幅な進歩を示すものであり、優れたユーザーエクスペリエンスを実現します。この記事では、基盤コンポーネントを使用してアダプティブフォームを作成するより従来的な方法について説明します。</span>

フォームの要素に入力された値を使用して、ドラフトまたはフォーム送信のメタデータフィールドを計算できます。 メタデータを使用すると、ユーザーデータに基づいてコンテンツをフィルタリングできます。 例えば、ユーザーがフォームの名前フィールドに John Doe と入力したとします。 この情報を使用してメタデータを計算することにより、この送信をイニシャル JD の下に分類できます。

ユーザーが入力した値でメタデータフィールドを計算するには、メタデータにフォームの要素を追加します。 この要素にユーザーが値を入力すると、スクリプトはその値を使用して情報を計算します。この情報はメタデータに追加されます。 要素をメタデータフィールドとして追加する場合、そのキーを指定します。 キーがメタデータのフィールドとして追加され、計算された情報がそのキーに対してログに記録されます。

例えば、健康保険会社がフォームを公開するとします。このフォームのフィールドで、エンドユーザーの年齢を取得します。顧客は、複数のユーザーがフォームを送信した後、特定の年齢範囲内のすべての送信を確認したいと考えています。 しかしそのままでは相応の手間がかかります。なぜならフォームの数が増加するほどデータは複雑化するからです。メタデータを追加すると、手間を軽減することができます。検索が最も簡単になるように、エンドユーザーが入力したプロパティやデータを最上位レベルに保存するように、フォーム作成者が設定できます。 追加のメタデータは、作成者が設定したとおりに、メタデータノードの最上位レベルに保存される、ユーザーが入力した情報です。

電子メール ID と電話番号を取り込むフォームの別の例を考えてみましょう。 ユーザーがフォームに匿名でアクセスしてからフォームを破棄した場合、メール ID と電話番号が自動保存されるようにフォームを設定できます。このフォームは自動保存され、電話番号と電子メール ID はドラフトのメタデータノードに保存されます。 この設定の使用例は、リード管理ダッシュボードです。

## メタデータへのフォーム要素の追加 {#adding-form-elements-to-metadata}

フォーム要素をメタデータに追加するには、次の手順を実行します。

1. アダプティブフォームを編集モードで開きます。\
   フォームを編集モードで開くには、フォームマネージャーでフォームを選択し、「 **開く**.
1. 編集モードで、コンポーネントを選択し、「 」を選択します。 ![フィールドレベル](assets/field-level.png) > **アダプティブフォームコンテナ**&#x200B;を選択し、 ![cmppr](assets/cmppr.png).
1. サイドバーで、 **メタデータ**.
1. 「メタデータ」セクションで、 **追加**.
1. スクリプトを追加するには、「メタデータ」タブの「値」フィールドを使用します。 追加したスクリプトは、フォーム上の要素からデータを収集し、メタデータに入力される値を計算します。

   例えば、入力された年齢が 21 才以上の場合はメタデータに **true** を記録し、21 才未満の場合は **false** を記録します。「メタデータ」タブで次のスクリプトを入力します。

   `(agebox.value >= 21) ? true : false`

   ![メタデータスクリプト](assets/add-element-metadata.png)

   「メタデータ」タブで入力されたスクリプト

1. 「**OK**」をクリックします。

メタデータフィールドとして選択された要素にユーザーがデータを入力すると、計算された情報がメタデータに記録されます。 メタデータは、メタデータを保存するように設定したリポジトリーで表示できます。

## フォーム送信メタデータの表示：  {#seeing-updated-form-nbsp-submission-metadata}

上記の例では、メタデータは CRX リポジトリーに保存されます。メタデータは次のようになります。

![メタデータ](assets/metadata_entry_new.png)

メタデータにチェックボックス要素を追加すると、選択された値がコンマで区切られた文字列として保存されます。例えば、フォームにチェックボックスコンポーネントを追加し、その名前を `checkbox1` として指定します。チェックボックスコンポーネントのプロパティで、値 0、1、および 2 に対して、運転免許、社会保障番号、パスポートの各項目を追加します。

![チェックボックスに入力された複数の値の保存](assets/checkbox-metadata.png)

アダプティブフォームコンテナを選択し、フォームのプロパティで `cb1` を保存するメタデータキー `checkbox1.value` を追加して、フォームを発行します。ユーザーがフォームに入力すると、チェックボックスの [ パスポートと社会保障番号 ] オプションが選択されます。 値 1 と 2 が送信メタデータの cb1 フィールドに「1, 2」として保存されます。

![チェックボックスフィールドで選択された複数の値のメタデータへの入力](assets/metadata-entry.png)

>[!NOTE]
>
>上記の例は学習目的のみで紹介しています。メタデータの検索は、AEM Forms実装で設定した正しい場所でおこなってください。
